(this["webpackJsonptrelliscopejs-lib"]=this["webpackJsonptrelliscopejs-lib"]||[]).push([[0],{172:function(e,t,a){e.exports=a(203)},182:function(e,t,a){},183:function(e,t,a){},184:function(e,t,a){},203:function(e,t,a){"use strict";a.r(t);var n=a(0),i=a.n(n),o=a(17),l=a.n(o),s=a(13),r=a(50),c=a(124),d=a(125),p=a(147),h=a(282),m=(a(181),a(108)),u=a.n(m),g=a(109),b=a.n(g);const f=["Panel Grid Layout","Filter Panels","Sort Panels","Show/Hide Labels","Views"],v={};f.forEach((e,t)=>{v[e]=t}),v[""]=-1;const y=e=>t=>a=>{const n=["SELECT_DISPLAY","SET_LAYOUT","SET_LABELS","SET_SORT","SET_FILTER","ACTIVE_SIDEBAR","SET_FILTER_VIEW"],i=t(a);if(n.indexOf(a.type)>-1){const t=(e=>{const t=e.selectedDisplay,a=e.layout,n="nrow=".concat(a.nrow,"&ncol=").concat(a.ncol,"&arr=").concat(a.arrange,"&pg=").concat(a.pageNum),i=e.labels,o=e.sort;o.sort((e,t)=>e.order>t.order?1:-1);const l=o.map(e=>"".concat(e.name,";").concat(e.dir)).join(","),s=e.filter,r=Object.keys(s.state).map(e=>{const t=s.state[e];let a="";if("select"===t.type)a="var:".concat(t.name,";type:select;val:").concat(t.value.map(encodeURIComponent).join("#"));else if("regex"===t.type)a="var:".concat(t.name,";type:regex;val:").concat(encodeURIComponent(t.regex));else if("range"===t.type){const e=t.value.from?t.value.from:"",n=t.value.to?t.value.to:"";a="var:".concat(t.name,";type:range;from:").concat(e,";to:").concat(n)}return a}),c=e.sidebar,d=v[c.active];let p="";s.view.active&&(p=s.view.active.join(","));return"display=".concat(t.name,"&").concat(n,"&labels=").concat(i.join(","),"&sort=").concat(l,"&filter=").concat(r.join(","),"&sidebar=").concat(d,"&fv=").concat(p)})(e.getState());window.location.hash!==t&&(window.location.hash=t)}return i},w=(e,t)=>e.classList?e.classList.contains(t):!!e.className.match(new RegExp("'(\\s|^)'".concat(t,"'(\\s|$)'"))),E=(e,t)=>{e.classList?e.classList.add(t):w(e,t)||(e.className+=" ".concat(t))},x=(e,t)=>{if(e.classList)e.classList.remove(t);else if(w(e,t)){const a=new RegExp("'(\\s|^)'".concat(t,"'(\\s|$)'"));e.className=e.className.replace(a," ")}};a(182),a(183),a(184);var S=a(97),_=a(148),O=a(149),C=a(60),I=a.n(C);const k=e=>{const t=window.HTMLWidgets.widgets;for(let a=0;a<t.length;a+=1)if(t[a].name===e)return t[a]};var N=a(107),D=a.n(N),j=a(126);const T=(e,t,a)=>"".concat(e.group,"_:_").concat(e.name,"_:_").concat(t,"_:_").concat(a),L=(e,t,a,n)=>{const i=T(e,a,n);if("API"===e.input_type){const o={display_id:"".concat(e.group,"___").concat(e.name),display_version:"v1",panel_id:a,cog_id:n,val:localStorage.getItem(i)===t?"":t},l=Object.entries(o).map(e=>e.join("=")).join("&");fetch("".concat(e.input_api.set,"?").concat(l),e.input_api.setRequestOptions).then(function(){var e=Object(j.a)(D.a.mark((function e(a){var n,o,l,s;return D.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o=null===(n=a.headers.get("content-type"))||void 0===n?void 0:n.includes("application/json"),e.t0=o,!e.t0){e.next=6;break}return e.next=5,a.json();case 5:e.t0=e.sent;case 6:if(l=e.t0,a.ok){e.next=10;break}return s=l&&l.message||a.status,e.abrupt("return",Promise.reject(s));case 10:localStorage.getItem(i)===t?localStorage.removeItem(i):localStorage.setItem(i,t);case 11:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).catch(e=>{console.error("There was an error setting the input.",e)})}"localStorage"===e.input_type&&(localStorage.getItem(i)===t?localStorage.removeItem(i):localStorage.setItem(i,t))},R=e=>Object(S.a)(e.url,t=>e.callback(t)),A=e=>({type:"WINDOW_RESIZE",dims:e}),P=e=>({type:"UPDATE_DIMS",dims:e}),z=e=>({type:"RECEIVE_CONFIG",config:e,receivedAt:Date.now()}),B=e=>({type:"ACTIVE_SIDEBAR",active:e}),W=e=>({type:"SET_DIALOG_OPEN",isOpen:e}),F=e=>({type:"SET_DISPSELECT_DIALOG_OPEN",isOpen:e}),H=e=>({type:"SET_DISPINFO_DIALOG_OPEN",isOpen:e}),M=e=>({type:"SET_LAYOUT",layout:e}),U=e=>({type:"SET_LABELS",labels:e}),V=e=>({type:"SET_SORT",sort:e}),G=e=>({type:"SET_FILTER",filter:e}),K=(e,t)=>({type:"SET_FILTER_VIEW",name:e,which:t}),Y=e=>({type:"RECEIVE_DISPLAY_LIST",list:e,receivedAt:Date.now()}),q=(e,t,a)=>({type:"SELECT_DISPLAY",name:e,group:t,desc:a}),Q=e=>({type:"SET_SELECTED_RELDISPS",which:"set",val:e}),J=e=>({type:"SET_REL_DISP_POSITIONS",obj:e}),$=(e,t)=>({type:"REQUEST_DISPLAY",name:e,group:t}),X=(e,t,a)=>({type:"RECEIVE_DISPLAY",name:e,group:t,info:a,receivedAt:Date.now()}),Z=(e,t)=>({type:"RECEIVE_COGDATA",iface:e,crossfilter:t,receivedAt:Date.now()}),ee=(e,t)=>({type:"SET_PANEL_RENDERER",name:e,fn:t}),te=e=>({type:"SET_ERROR_MESSAGE",msg:e}),ae=(e,t,a,n,i)=>{const o={};i.replace("#","").split("&").forEach(e=>{const t=e.split("=");o[t[0]]=t[[1]]});for(let u=0;u<t.length;u+=1)t[u].__index=u;n(Z(e,Object(_.a)(t)));let l=a.state.sidebar;o.sidebar&&(l=parseInt(o.sidebar,10)),l&&l>=0&&n(B(f[l]));const s=a.state.layout;o.nrow&&(s.nrow=parseInt(o.nrow,10)),o.ncol&&(s.ncol=parseInt(o.ncol,10)),o.arr&&(s.arrange=o.arr),n(M(s)),o.pg&&n(M({pageNum:parseInt(o.pg,10)}));let r=a.state.labels;o.labels&&(r=o.labels.split(",")),n(U(r));let c=a.state.sort;o.sort&&(c=o.sort.split(",").map((e,t)=>{const a=e.split(";");return{order:t+1,name:a[0],dir:a[1]}})),n(V(c));const d=a.state.filter?a.state.filter:{};if(o.filter){o.filter.split(",").forEach(e=>{const t={};e.split(";").forEach(e=>{const a=e.split(":");t[a[0]]=a[[1]]});const n={name:t.var,type:t.type,varType:a.cogInfo[t.var].type};if("select"===t.type)n.orderValue="ct,desc",n.value=t.val.split("#").map(decodeURIComponent);else if("regex"===t.type){const e=a.cogInfo[t.var].levels,i=[],o=new RegExp(decodeURIComponent(t.val),"i");e.forEach(e=>{null!==e.match(o)&&i.push(e)}),n.regex=t.val,n.value=i,n.orderValue="ct,desc"}else if("range"===t.type){const e=t.from?parseFloat(t.from,10):void 0,a=t.to?parseFloat(t.to,10):void 0;n.value={from:e,to:a},n.valid=!0,e&&a&&e>a&&(n.valid=!1)}d[t.var]=n})}let p=[];o.fv&&(p=o.fv.split(","));const h=Object.keys(a.cogInfo),m={active:[],inactive:[]};for(let u=0;u<h.length;u+=1)a.cogInfo[h[u]].filterable&&(p.indexOf(h[u])>-1||a.state.filter&&void 0!==a.state.filter[h[u]]?m.active.push(h[u]):m.inactive.push(h[u]));n(K(m,"set")),n(G(d))},ne=(e,t,a)=>{if("image"===e.panelInterface.type)a(ee(e.name,(e,t,a)=>i.a.createElement("img",{src:e,alt:"panel",style:{width:t,height:a}})));else if("image_src"===e.panelInterface.type)a(ee(e.name,e=>i.a.createElement("img",{src:e,alt:"panel",style:{width:"100%",height:"100%",objectFit:"contain"}})));else if("htmlwidget"===e.panelInterface.type){const n=()=>{const t=k(e.panelInterface.deps.name);a(ee(e.name,(e,a,n,o,l)=>{const s=document.getElementById("widget_outer_".concat(l)),r=document.getElementById("widget_".concat(l));if(!o||!s||null!==r)return i.a.createElement("div",{id:"widget_outer_".concat(l)});{const i=document.createElement("div");let o;i.style.width="".concat(a,"px"),i.style.height="".concat(n,"px"),i.setAttribute("id","widget_".concat(l)),s.appendChild(i),t.initialize&&(o=t.initialize(i,a,n)),e.evals instanceof Array||(e.evals=[e.evals]);for(let t=0;e.evals&&t<e.evals.length;t+=1)window.HTMLWidgets.evaluateStringMember(e.x,e.evals[t]);t.renderValue(i,e.x,o)}return null}))};t.config_base?((e,t,a)=>{const n=Object.assign([],e.assets),i=()=>{let e=!1;const o=document.getElementsByTagName("head")[0],l=t=>{if(!e){const o=t;o.onreadystatechange=null,o.onload=null,e=!0,0!==n.length?i():a()}},s=n.shift();s.url.constructor===String&&(s.url=[s.url]);for(let a=0;a<s.url.length;a+=1){let e;"script"===s.type?(e=document.createElement("script"),e.type="text/javascript",e.src="".concat(t).concat(s.url[a])):"stylesheet"===s.type&&(e=document.createElement("link"),e.rel="stylesheet",e.type="text/css",e.href="".concat(t).concat(s.url[a])),e.onreadystatechange=()=>{"complete"!==(void 0).readyState&&"loaded"!==(void 0).readyState||l(e)},e.onload=l,o.appendChild(e)}};i()})(e.panelInterface.deps,t.config_base,n):"__self__"===t.display_base&&n()}},ie=(e,t,a,n="",i="",o=!0)=>l=>{l($(e,t));const s="__loadDisplayObj__".concat(n,"_").concat(t,"_").concat(e),r="__loadCogData__".concat(n,"_").concat(t,"_").concat(e);window[s]=n=>{const s=n.cogInterface;l(X(e,t,n)),ne(n,a,l),n.showMdDesc&&l(H(!0)),o&&(l(Z(s)),window[r]=e=>{ae(s,e,n,l,i)},"jsonp"===a.data_type?I()({url:"".concat(a.display_base).concat(s.group,"/").concat(s.name,"/cogData.jsonp"),callbackName:"cdCallback",error:e=>l(te("Couldn't load cognostics data: ".concat(e.url)))}):R({url:"".concat(a.display_base).concat(s.group,"/").concat(s.name,"/cogData.json"),callback:window[r]}).on("error",e=>l(te("Couldn't load display list: ".concat(e.target.responseURL)))),n.has_inputs&&"API"===n.input_type&&(e=>{const t={display_id:"".concat(e.group,"___").concat(e.name),display_version:"v1"},a=Object.entries(t).map(e=>e.join("=")).join("&");fetch("".concat(e.input_api.get,"?").concat(a),e.input_api.getRequestOptions).then(e=>{var t;const a=(null===(t=e.headers.get("content-type"))||void 0===t?void 0:t.includes("application/json"))&&e.json();if(!e.ok){return a&&a.message||e.status}return e.json()}).then(t=>{if(t.success){const a=new RegExp("^".concat((e=>"".concat(e.group,"_:_").concat(e.name,"_:"))(e)),"g");Object.keys(localStorage).forEach(e=>{e.match(a)&&localStorage.removeItem(e)}),Object.keys(t.panels).forEach(a=>{Object.keys(t.panels[a]).forEach(n=>{const i=T(e,a,n),o=t.panels[a][n];""!==o&&localStorage.setItem(i,o)})})}}).catch(e=>{console.error("There was an error getting inputs stored in the API.",e)})})(n))},"jsonp"===a.data_type?I()({url:"".concat(a.display_base).concat(t,"/").concat(e,"/displayObj.jsonp"),callbackName:"ldCallback",error:e=>l(te("Couldn't load display object: ".concat(e.url)))}):R({url:"".concat(a.display_base).concat(t,"/").concat(e,"/displayObj.json"),callback:window[s]}).on("error",e=>l(te("Couldn't load display list: ".concat(e.target.responseURL))))};var oe=a(9);const le=e=>e._displayList,se=e=>e.selectedDisplay&&""!==e.selectedDisplay.name&&e._displayInfo[e.selectedDisplay.name]?e._displayInfo[e.selectedDisplay.name]:{isFetching:!0,isLoaded:!1,didInvalidate:!1,info:{}},re=e=>e.selectedDisplay,ce=e=>e._cogDataMutable,de=e=>e.layout.pageNum?e.layout.pageNum:-1,pe=e=>e.layout.nrow*e.layout.ncol,he=e=>e.filter.state,me=e=>e.filter.view,ue=e=>e.sort,ge=e=>e.layout,be=e=>e.labels,fe=e=>e._config.config,ve=e=>e.appId,ye=e=>e.singlePageApp,we=e=>e.fullscreen,Ee=e=>e.dialog,xe=Object(oe.a)(se,e=>e.isLoaded?e.info.height/e.info.width:0),Se=Object(oe.a)(ce,he,me,se,(e,t,a,n)=>{const i={};if(e.iface&&a.active&&e.crossfilter&&"JSON"===e.iface.type){const o=a.active;for(let a=0;a<o.length;a+=1)if("factor"===n.info.cogInfo[o[a]].type){const n=t[o[a]]&&t[o[a]].orderValue?t[o[a]].orderValue:"ct,desc";let l=[];e.groupRefs[o[a]]&&(l="ct"===n.substr(0,2)?e.groupRefs[o[a]].top(1/0):e.groupRefs[o[a]].all());const s=["ct,asc","id,desc"].indexOf(n)<0;let r=0;for(let e=0;e<l.length;e+=1)l[e].value>r&&(r=l[e].value);const c=[],d=[],p=t[o[a]]&&t[o[a]].value?t[o[a]].value:[];let h=0;for(let e=0;e<l.length;e+=1){p.indexOf(l[e].key)<0?d.push(e):(c.push(e),h+=l[e].value)}i[o[a]]={dist:l,max:r,orderValue:n,reverseRows:s,totSelected:c.length,sumSelected:h,idx:c.concat(d)}}else if("numeric"===n.info.cogInfo[o[a]].type){const t=e.groupRefs[o[a]].all();let l=0;for(let e=0;e<t.length;e+=1)t[e].value>l&&(l=t[e].value);i[o[a]]={dist:t,max:l,breaks:n.info.cogInfo[o[a]].breaks,delta:n.info.cogInfo[o[a]].delta,range:n.info.cogInfo[o[a]].range,log:n.info.cogInfo[o[a]].log}}}return i}),_e=Object(oe.a)(ce,de,pe,he,ue,(e,t,a,n,i)=>{let o=[];return e.dimensionRefs&&e.dimensionRefs.__sort&&n&&i&&(o=1===i.length?"asc"===i[0].dir?e.dimensionRefs.__sort.bottom(a,(t-1)*a):e.dimensionRefs.__sort.top(a,(t-1)*a):e.dimensionRefs.__sort.bottom(a,(t-1)*a)),o}),Oe=Object(oe.a)(ce,he,(e,t)=>void 0===e.allRef&&t?0:e.allRef.value());var Ce=e=>{const t=Object.keys(e);return a=>a=>n=>(-1!==t.indexOf(n.type)&&e[n.type](),a(n))};const Ie=(e,t)=>Number.isNaN(e[t]||void 0===e[t])?-9007199254740992:e[t],ke=(e,t,a)=>{const n="asc"===a?1:0;return Number.isNaN(e[t])||void 0===e[t]?9007199254740992*n:e[t]},Ne=(e,t)=>e[t]?e[t]:"NA",De=e=>{let t=1,a=e;return"!"===e[0]&&(t=-1,a=a.substr(1)),(e,n)=>(e[a]<n[a]?-1:e[a]>n[a]?1:0)*t};var je=e=>t=>a=>{if("SET_FILTER"===a.type&&a.filter){const t=e.getState()._cogDataMutable.crossfilter,n=e.getState()._cogDataMutable.dimensionRefs,i=e.getState()._cogDataMutable.groupRefs;if("string"===typeof a.filter||a.filter instanceof String)n[a.filter].filter(null);else{const o=Object.keys(a.filter);0===o.length&&n&&Object.keys(e.getState().filter.state).forEach(e=>n[e].filter(null));for(let l=0;l<o.length;l+=1)if("numeric"===a.filter[o[l]].varType){if(void 0===n[o[l]]&&(n[o[l]]=t.dimension(e=>Ie(e,o[l]))),void 0===i[o[l]]){const t=e.getState().selectedDisplay.name,a=e.getState()._displayInfo[t].info.cogInfo[o[l]];i[o[l]]=n[o[l]].group(e=>Number.isNaN(e)||void 0===e?null:a.breaks[Math.floor((e-a.breaks[0])/a.delta)])}if(void 0===a.filter[o[l]].value)n[o[l]].filter(null);else{let e=a.filter[o[l]].value.from,t=a.filter[o[l]].value.to;e=void 0===e?-1/0:e,t=void 0===t?1/0:t,n[o[l]].filterFunction(a=>a>=e&&a<=t)}}else if("factor"===a.filter[o[l]].varType)if(void 0===n[o[l]]&&(n[o[l]]=t.dimension(e=>Ne(e,o[l]))),void 0===i[o[l]]&&(i[o[l]]=n[o[l]].group()),void 0===a.filter[o[l]].value)n[o[l]].filter(null);else{const e=a.filter[o[l]].value;n[o[l]].filter(t=>e.indexOf(t)>-1)}}}else if("SET_FILTER_VIEW"===a.type){if("add"===a.which||"set"===a.which){const t=e.getState()._cogDataMutable.crossfilter,n=e.getState()._cogDataMutable.dimensionRefs,i=e.getState()._cogDataMutable.groupRefs,o=e.getState().selectedDisplay.name;let l=[];"add"===a.which?l.push(a.name):l=a.name.active,l.forEach(a=>{const l=e.getState()._displayInfo[o].info.cogInfo[a].type;if(void 0===n[a]&&(n[a]="numeric"===l?t.dimension(e=>Ie(e,a)):t.dimension(e=>Ne(e,a))),void 0===i[a])if("numeric"===l){const t=e.getState()._displayInfo[o].info.cogInfo[a];i[a]=n[a].group(e=>Number.isNaN(e)||void 0===e?null:t.breaks[Math.floor((e-t.breaks[0])/t.delta)])}else i[a]=n[a].group()})}}else if("SET_SORT"===a.type&&void 0!==a.sort){const t=e.getState()._cogDataMutable.crossfilter,n=e.getState()._cogDataMutable.dimensionRefs;if(n){n.__sort&&n.__sort.remove();let i=a.sort;if("number"===typeof a.sort&&(i=Object.assign([],[],e.getState().sort),i.splice(a.sort,1)),0===i.length)n.__sort=t.dimension(e=>e.__index);else if(1===i.length){const a=e.getState().selectedDisplay.name,o=e.getState()._displayInfo[a].info.cogInfo[i[0].name];"factor"===o.type?n.__sort=t.dimension(e=>Ne(e,i[0].name)):"numeric"===o.type&&(n.__sort=t.dimension(e=>ke(e,i[0].name,i[0].dir)))}else{const a=t.all(),o=[];for(let t=0;t<a.length;t+=1){const n={__index:a[t].__index};for(let o=0;o<i.length;o+=1){const l=e.getState().selectedDisplay.name,s=e.getState()._displayInfo[l].info.cogInfo[i[o].name];"factor"===s.type?n[i[o].name]=Ne(a[t],i[o].name):"numeric"===s.type&&(n[i[o].name]=ke(a[t],i[o].name,i[o].dir))}o.push(n)}const l=[];for(let e=0;e<i.length;e+=1)l.push("".concat("asc"===i[e].dir?"":"!").concat(i[e].name));o.sort((e=>{const t=e;return(e,a)=>{let n=0,i=0;for(;0===i&&n<t.length;)i=De(t[n])(e,a),n+=1;return i}})(l));const s={};for(let e=0;e<o.length;e+=1)s[o[e].__index]=e;n.__sort=t.dimension(e=>s[e.__index])}}}return t(a)},Te=a(8);var Le=(e={active:""},t)=>{switch(t.type){case"ACTIVE_SIDEBAR":return Object(Te.a)(Object(Te.a)({},e),{},{active:t.active===e.active?"":t.active})}return e};const Re="object"===typeof window?window.innerHeight:null,Ae="object"===typeof window?window.innerWidth:null;var Pe=(e={windowHeight:Re,windowWidth:Ae,origHeight:void 0,origWidth:void 0},t)=>{switch(t.type){case"WINDOW_RESIZE":return Object(Te.a)(Object(Te.a)({},e),{},{windowHeight:t.dims.height,windowWidth:t.dims.width});case"UPDATE_DIMS":return Object(Te.a)(Object(Te.a)({},e),{},{origHeight:t.dims.height,origWidth:t.dims.width})}return e};var ze=(e={},t)=>{switch(t.type){case"SET_PANEL_RENDERER":return Object(Te.a)(Object(Te.a)({},e),{},{[t.name]:{fn:t.fn}})}return e},Be=a(127),We=a.n(Be);const Fe=Object(r.c)({state:(e={},t)=>{switch(t.type){case"SET_FILTER":return"string"===typeof t.filter||t.filter instanceof String?We()(e,t.filter):void 0===t.filter||0===Object.keys(t.filter).length&&t.filter.constructor===Object?{}:Object(Te.a)(Object(Te.a)({},e),t.filter)}return e},view:(e={active:[],inactive:[]},t)=>{switch(t.type){case"SET_FILTER_VIEW":{let a=Object(Te.a)({},e);if(void 0===a.active&&(a.active=[]),void 0===a.inactive&&(a.inactive=[]),"remove"===t.which){const e=a.active.indexOf(t.name);e>-1&&a.active.splice(e,1);a.inactive.indexOf(t.name)<0&&a.inactive.push(t.name)}else if("add"===t.which){const e=a.inactive.indexOf(t.name);e>-1&&a.inactive.splice(e,1);a.active.indexOf(t.name)<0&&a.active.push(t.name)}else"set"===t.which&&(a=t.name);return a}}return e}});var He=(e={isFetching:!1,isLoaded:!1,didInvalidate:!1,config:{}},t)=>{switch(t.type){case"REQUEST_CONFIG":return Object(Te.a)(Object(Te.a)({},e),{},{isFetching:!0,isLoaded:!1,didInvalidate:!1});case"RECEIVE_CONFIG":return Object(Te.a)(Object(Te.a)({},e),{},{isFetching:!1,didInvalidate:!1,isLoaded:!0,config:t.config,lastUpdated:t.receivedAt});default:return e}};var Me=(e={isFetching:!1,isLoaded:!1,didInvalidate:!1,list:[]},t)=>{switch(t.type){case"REQUEST_DISPLAY_LIST":return Object(Te.a)(Object(Te.a)({},e),{},{isFetching:!0,isLoaded:!1,didInvalidate:!1});case"RECEIVE_DISPLAY_LIST":return Object(Te.a)(Object(Te.a)({},e),{},{isFetching:!1,didInvalidate:!1,isLoaded:!0,list:t.list,lastUpdated:t.receivedAt});default:return e}};var Ue=(e={},t)=>{switch(t.type){case"REQUEST_DISPLAY":return Object(Te.a)(Object(Te.a)({},e),{},{[t.name]:{isFetching:!0,isLoaded:!1,info:{},didInvalidate:!1}});case"RECEIVE_DISPLAY":return Object(Te.a)(Object(Te.a)({},e),{},{[t.name]:{isFetching:!1,didInvalidate:!1,isLoaded:!0,info:t.info,lastUpdated:t.receivedAt}});default:return e}};var Ve=(e={isFetching:!1,isLoaded:!1,didInvalidate:!1},t)=>{switch(t.type){case"REQUEST_COGDATA":return Object(Te.a)(Object(Te.a)({},e),{},{isFetching:!0,isLoaded:!1,didInvalidate:!1});case"RECEIVE_COGDATA":return Object(Te.a)(Object(Te.a)({},e),{},{isFetching:!1,didInvalidate:!1,isLoaded:!0,crossfilter:t.crossfilter,dimensionRefs:{},groupRefs:{},allRef:void 0!==t.crossfilter?t.crossfilter.groupAll():void 0,iface:t.iface,lastUpdated:t.receivedAt});default:return e}};var Ge=(e={},t)=>{switch(t.type){case"SET_LOCAL_PANELS":return Object(Te.a)(Object(Te.a)({},e),t.dat)}return e};var Ke=Object(r.c)({appId:(e="app",t)=>{switch(t.type){case"SET_APP_ID":return t.id}return e},dialog:(e=!1,t)=>{switch(t.type){case"SET_DIALOG_OPEN":return t.isOpen}return e},dispSelectDialog:(e=!1,t)=>{switch(t.type){case"SET_DISPSELECT_DIALOG_OPEN":return t.isOpen}return e},dispInfoDialog:(e=!1,t)=>{switch(t.type){case"SET_DISPINFO_DIALOG_OPEN":return t.isOpen}return e},singlePageApp:(e=!0,t)=>{switch(t.type){case"SET_SINGLE_PAGE_APP":return t.singlePageApp}return e},fullscreen:(e=!0,t)=>{switch(t.type){case"SET_FULLSCREEN":return t.fullscreen}return e},ui:Pe,sidebar:Le,errorMsg:(e="",t)=>{switch(t.type){case"SET_ERROR_MESSAGE":return t.msg}return e},selectedDisplay:(e={name:"",group:"",desc:""},t)=>{switch(t.type){case"SELECT_DISPLAY":return Object(Te.a)(Object(Te.a)({},e),{},{name:t.name,group:t.group,desc:t.desc})}return e},selectedRelDisps:(e=[],t)=>{switch(t.type){case"SET_SELECTED_RELDISPS":{const a=Object.assign([],e);if("add"===t.which)a.indexOf(t.val)<0&&a.push(t.val);else if("remove"===t.which){const e=a.indexOf(t.val);e>-1&&a.splice(e,1)}else{if("reset"===t.which)return[];if("set"===t.which)return t.val}return a.sort(),a}}return e},relDispPositions:(e=[],t)=>{switch(t.type){case"SET_REL_DISP_POSITIONS":return Object.assign([],[],t.obj)}return e},panelRenderers:ze,layout:(e={nrow:1,ncol:1,arrange:"row",pageNum:1},t)=>{switch(t.type){case"SET_LAYOUT":{const a=Object(Te.a)({},t.layout);if(a.nrow||a.ncol){const t=e.nrow*e.ncol*(e.pageNum-1)+1;a.pageNum=Math.ceil(t/(a.nrow*a.ncol)),Number.isNaN(a.pageNum)&&(a.pageNum=1)}return Object(Te.a)(Object(Te.a)({},e),a)}}return e},labels:(e=[],t)=>{switch(t.type){case"SET_LABELS":return Object.assign([],[],t.labels)}return e},sort:(e=[],t)=>{switch(t.type){case"SET_SORT":if("number"===typeof t.sort){const a=Object.assign([],[],e);return a.splice(t.sort,1),a}return void 0===t.sort?[]:Object.assign([],[],t.sort)}return e},filter:Fe,_config:He,_displayList:Me,_displayInfo:Ue,_cogDataMutable:Ve,_localPanels:Ge}),Ye=a(12),qe=a(11),Qe=a.n(qe),Je=a(128),$e=a.n(Je),Xe=a(260),Ze=a(290),et=a(261),tt=a(262),at=a(263);var nt={fontFamily:'"Open Sans", sans-serif',header:{height:48,fontSize:16,borderColor:"#eaedf0",background:"white",color:"#000",button:{color:"#9ba3af",active:{background:"#448AFF"}},logo:{background:"#FF4308",color:"white"},logoWidth:130},footer:{height:30,background:"#666666",color:"white",button:{background:"#90CAF9",color:"white"}},sideButtons:{width:48,fontSize:22,labelFontSize:11,background:"#b3b3b3",spacerBackground:"#c1c1c1",button:{color:"white",borderColor:"#c0c0c0",active:{color:"#448AFF",background:"white"},hover:{background:"#448AFF"}}},sidebar:{width:230,borderColor:"#c1c1c1",header:{fontSize:15,height:25,background:"#c1c1c1",color:"white"},filter:{margin:5,cat:{height:125,bar:{height:15,color:{default:"#eee",hover:"rgb(255, 192, 76)",select:"rgb(255, 170, 10)",noneSelect:"rgb(255, 210, 127)"}},text:{color:{default:"#888",hover:"#000",select:"#000"}}},num:{height:100,barColor:"rgb(255, 210, 127)"},variables:{height:50}}},content:{panel:{pad:2},label:{height:15,fontSize:12}},trans:{duration:"300ms",timing:"ease"}};const it={passoverHTML:!1,passoverAttribute:"passover",stripPassoverAttribute:!0};class ot extends i.a.Component{constructor(...e){super(...e),this.handleOpen=()=>{const e=this.props,t=e.setDialogOpen,a=e.setThisDialogOpen;t(!0),a(!0),Qe.a.bind("esc",this.handleClose)},this.handleKey=()=>{const e=this.props,t=e.setDialogOpen,a=e.setThisDialogOpen;t(!0),a(!0),Qe.a.bind("esc",this.handleClose)},this.handleClose=()=>{const e=this.props,t=e.setDialogOpen,a=e.setThisDialogOpen;t(!1),a(!1),Qe.a.unbind("esc")}}componentDidMount(){const e=this.props,t=e.active,a=e.fullscreen;t&&a&&Qe.a.bind("i",this.handleKey)}UNSAFE_componentWillReceiveProps(e){e.active&&e.fullscreen?Qe.a.bind("i",this.handleKey):Qe.a.unbind("i")}componentWillUnmount(){const e=this.props,t=e.active,a=e.fullscreen;t&&a&&Qe.a.unbind("i")}render(){const e=this.props,t=e.classes,a=e.curDisplayInfo,n=e.singleDisplay,o=e.styles;let l="";if(a.isLoaded){const e=$e()(a.info.mdDesc,it);let n="";a.info.desc&&(n=i.a.createElement("em",null,a.info.desc));const o=i.a.createElement("div",null,i.a.createElement("div",{style:{background:"#ededed",padding:5}},i.a.createElement("strong",null,a.info.name),i.a.createElement("br",null),n),i.a.createElement("p",null,"This visualization contains ".concat(a.info.n,' "panels" that you can interactively view through various controls. Each panel has a set of variables or metrics, called "cognostics", that you can use to sort and filter the panels that you want to view.')),i.a.createElement("p",null,"To learn more about how to interact with this visualization, click the \u201c?\u201d icon in the top right corner of the display."),a.info.has_inputs&&i.a.createElement("p",null,"There are user input variables available in this visualization with which you can provide feedback for any panel. These will show up as either a radio button or free text entry in the labels that show up under each panel. As you enter inputs, these are saved in your local web browser's storage and will be remembered in subsequent views of the display."),a.info.has_inputs&&i.a.createElement("p",null,"If you'd like to pull the data that you have input, you can click the \u201cExport Inputs\u201d button at the bottom left corner of the display and follow the prompts in the dialog box that pops up.")),s=this.props.isOpen;l=i.a.createElement(Ze.a,{open:s,className:"trelliscope-app",style:{zIndex:8e3,fontWeight:300},"aria-labelledby":"dialog-info-title",onBackdropClick:this.handleClose,disableEscapeKeyDown:!0,maxWidth:"md"},i.a.createElement(Xe.a,{id:"dialog-info-title"},"".concat(a.info.mdTitle)),i.a.createElement(et.a,null,i.a.createElement("div",{className:t.modalContainer},o,i.a.createElement("div",{dangerouslySetInnerHTML:{__html:e}}))),i.a.createElement(tt.a,null,i.a.createElement(at.a,{color:"secondary",onClick:this.handleClose},"Close")))}return i.a.createElement("div",null,i.a.createElement("button",{type:"button",onClick:this.handleOpen,className:t.button,style:n?o.single:o.button},i.a.createElement("i",{className:"".concat(t.icon," icon-info_outline")})),l)}}const lt={button:{position:"absolute",boxSizing:"border-box",top:-1,display:"inline-block",height:nt.header.height,width:nt.header.height-1,fontSize:18,paddingTop:0,color:nt.header.button.color,background:"none",textAlign:"center",borderRight:"1px solid ".concat(nt.header.borderColor),borderBottom:"1px solid ".concat(nt.header.borderColor),borderTop:"none",borderLeft:"none","&:hover":{transition:"background 250ms",background:"#eee",cursor:"pointer"}},icon:{paddingLeft:2,lineHeight:"".concat(nt.header.height,"px")},modalContainer:{overflowY:"auto",maxHeight:520}},st=Object(oe.a)(re,se,we,e=>e.dispInfoDialog,(e,t,a,n)=>({styles:{button:{left:""===e.name?-nt.sideButtons.width:nt.sideButtons.width},single:{left:""===e.name?-nt.sideButtons.width:0}},curDisplayInfo:t,fullscreen:a,active:""!==e.name,isOpen:n}));var rt=Object(s.b)(e=>st(e),e=>({setThisDialogOpen:t=>{e(H(t))}}))(Object(Ye.a)(lt)(ot)),ct=a(292),dt=a(269),pt=a(270),ht=a(268),mt=a(89),ut=a.n(mt),gt=a(90),bt=a.n(gt),ft=a(151),vt=a(266),yt=a(264),wt=a(267),Et=a(265),xt=a(288),St=a(130),_t=a.n(St);const Ot=Object(oe.a)(se,le,(e,t)=>{const a={};if(e.isLoaded){const n=e.info.keySig,i=[e.info.group,e.info.name].join("/");t.list.forEach((e,t)=>{const o=e.keySig===n,l=[e.group,e.name].join("/");o&&l!==i&&(a[e.group]||(a[e.group]=[]),a[e.group].push(t))})}return a}),Ct=e=>e.selectedRelDisps,It=(Object(oe.a)(se,le,Ct,(e,t,a)=>{const n=[];return t.isLoaded&&e.isLoaded&&n.push({aspect:e.info.height/e.info.width,group:e.info.group,name:e.info.name}),a.forEach(e=>{n.push({aspect:t.list[e].height/t.list[e].width,group:t.list[e].group,name:t.list[e].name})}),n}),Object(oe.a)(se,e=>e.info.cogInfo?e.info.cogInfo:{})),kt=Object(oe.a)(le,e=>{const t={};if(e.list)for(let a=0;a<e.list.length;a+=1)t[e.list[a].group]||(t[e.list[a].group]=[]),t[e.list[a].group].push(a);return t}),Nt=e=>e.ui.windowWidth,Dt=e=>e.ui.windowHeight,jt=e=>e.sidebar.active,Tt=Object(oe.a)(Dt,e=>e-nt.header.height-nt.footer.height-nt.sidebar.header.height),Lt=Object(oe.a)(me,se,Tt,(e,t,a)=>{const n=e.active;if(void 0===n)return{cutoff:null,heights:[0,0]};const i=n.map(e=>{if(!t.isLoaded)return 0;if("factor"===t.info.cogInfo[e].type){const a=t.info.cogInfo[e].levels?t.info.cogInfo[e].levels.length:1e3;return Math.min(nt.sidebar.filter.cat.height,15*a)+54}return"numeric"===t.info.cogInfo[e].type?nt.sidebar.filter.num.height+54:0});let o=null,l=0,s=0;for(let r=0;r<i.length;r+=1)null===o?l+i[r]>a?(o=r,s+=i[r]):l+=i[r]:s+=i[r];return null===o&&l+30+nt.sidebar.filter.variables.height>a&&(o=i.length),{cutoff:o,heights:[l,s]}}),Rt=Object(oe.a)(Nt,jt,Lt,(e,t,a)=>{const n=nt.sidebar.width*(1+("Filter Panels"===t&&a&&null!==a.cutoff));return e-nt.sideButtons.width-(""===t?0:n+1)}),At=Object(oe.a)(Dt,e=>e-nt.header.height-nt.footer.height),Pt={container:{height:400,overflowY:"auto"},groupContainer:{display:"flex",flexWrap:"wrap",justifyContent:"space-around"},gridList:{width:700,marginBottom:24},gridTile:{cursor:"pointer"},gridTitle:{fontWeight:400,color:_t.a.A200,fontSize:15},gridSubtitle:{fontStyle:"italic",fontSize:11},img:{opacity:1,"&:hover":{opacity:.7}},titleBar:{background:"rgba(0, 0, 0, 0.8) !important"},checkbox:{position:"absolute !important",left:0,top:0,background:"rgba(69, 138, 249, 0.9) !important",color:"white !important","&checked":{color:"white !important"}},disclaimer:{paddingLeft:10,fontSize:13,marginTop:-3}},zt=Object(oe.a)(re,Ct,fe,ve,At,Rt,(e,t,a,n,i,o)=>({selectedDisplay:e,selectedRelDisps:t,appId:n,cfg:a,contentHeight:i,contentWidth:o}));var Bt=Object(s.b)(e=>zt(e),e=>({handleCheckbox:(t,a,n,i,o,l,s,r)=>{const c=a.indexOf(t)>-1,d=Object.assign([],a);if(c){const e=d.indexOf(t);e>-1&&d.splice(e,1)}else d.indexOf(t)<0&&(e(ie(i[t].name,i[t].group,s,r,"",!1)),d.push(t));d.sort();const p=((e,t,a,n,i)=>{const o=[a.map(e=>e.name).indexOf(e.name),...t],l=o.length,s=n/i,r=[];for(let v=1;v<=l;v+=1)l/v===Math.floor(l/v)&&r.push([v,l/v]);const c=[],d=i*n;r.forEach((e,t)=>{const l=e[0],r=e[1],p=e[1]/e[0]*s,h=i/r,m=n/l;let u=0;for(let n=0;n<l*r;n+=1){const e=a[o[n]].height/a[o[n]].width;let t=h,i=t*e;p<e&&(i=m,t=i/e),u+=t*i}c[t]=d-u});const p=r[c.indexOf(Math.min.apply(null,c))],h=p[0],m=p[1],u=p[1]/p[0]*s,g=i/n/m,b=1/h,f=o.map((e,t)=>{const n=Math.floor(t/m),i=t%m,o=a[e].height/a[e].width;let l=g,s=l*o;return u<o&&(s=b,l=s/o),{idx:e,name:a[e].name,group:a[e].group,aspect:o,left:i*g,top:n*b,width:l,height:s,row:n,col:i}});return 1===f.length&&f[0].name===e.name?[]:f})(n,d,i,o,l);e(M({nrow:1,ncol:1})),e(Q(d)),e(J(p))}}))(Object(Ye.a)(Pt)(({classes:e,selectable:t,di:a,displayGroups:n,handleClick:o,cfg:l,appId:s,selectedDisplay:r,selectedRelDisps:c,handleCheckbox:d,contentHeight:p,contentWidth:h})=>{const m=Object.keys(n),u=m.map(u=>{return i.a.createElement("div",{className:e.groupContainer,key:u},i.a.createElement(vt.a,{cellHeight:180,cols:3,className:e.gridList},(g=u,m.length>1?i.a.createElement(yt.a,{key:"Subheader",cols:3,style:{height:"auto"}},i.a.createElement(Et.a,{style:{fontSize:20,color:"black"},component:"div"},g)):null),n[u].map(n=>i.a.createElement(yt.a,{key:n,className:e.gridTile,onClick:()=>{t?d(n,c,r,a,p,h,l,s):o(a[n].name,a[n].group,a[n].desc)}},i.a.createElement("img",{src:"".concat(l.cog_server.info.base,"/").concat(a[n].group,"/").concat(a[n].name,"/thumb.png"),alt:a[n].name,className:e.img,key:"img".concat(n)}),t&&i.a.createElement(xt.a,{classes:{root:e.checkbox},checked:c.indexOf(n)>-1,onChange:()=>{d(n,c,r,a,p,h,l,s)},value:"checked".concat(n),inputProps:{}}),i.a.createElement(wt.a,{classes:{root:e.titleBar},title:i.a.createElement("div",{className:e.gridTitle},a[n].name.replace(/_/g," ")),subtitle:i.a.createElement("span",{style:{fontSize:13}},a[n].desc,i.a.createElement("br",null),i.a.createElement("span",{className:e.gridSubtitle},a[n].n,"\xa0panels,",a[n].updated.substring(0,a[n].updated.length-3)))}))),l.disclaimer?i.a.createElement(yt.a,{cols:l.disclaimer.cols},i.a.createElement("div",{className:e.disclaimer,dangerouslySetInnerHTML:{__html:l.disclaimer.text}})):""));var g});return i.a.createElement("div",{className:e.container},u)}));const Wt={display:"flex",alignItems:"center",justifyContent:"center",border:"solid 1px #ddd",background:"rgba(69, 138, 249, 0.4)"},Ft=e=>parseInt(e.replace("px",""),10);class Ht extends i.a.Component{constructor(e){super(e),this.handleOpen=()=>{(0,this.props.setDialogOpen)(!0),this.setState({open:!0}),Qe.a.bind("esc",this.handleClose)},this.handleKey=()=>{(0,this.props.setDialogOpen)(!0),this.setState({open:!0}),Qe.a.bind("esc",this.handleClose)},this.handleClose=()=>{(0,this.props.setDialogOpen)(!1),this.setState({open:!1}),Qe.a.unbind("esc")},this.setStep=e=>{this.setState({activeStep:e})},this.handleNext=()=>{this.setState({activeStep:1})},this.handleBack=()=>{this.setState({activeStep:0})},this.state={open:!1,activeStep:0}}componentDidMount(){this.props.active&&Qe.a.bind("r",this.handleKey)}UNSAFE_componentWillReceiveProps(e){e.active?Qe.a.bind("r",this.handleKey):Qe.a.unbind("r")}componentWillUnmount(){this.props.active&&Qe.a.unbind("r")}render(){const e=this.props,t=e.classes,a=e.styles,n=e.relatedDisplayGroups,o=e.displayList,l=e.contentHeight,s=e.contentWidth,r=e.selectedRelDisps,c=e.relDispPositions,d=e.handleResize,p=this.state,h=p.open,m=p.activeStep,u={position:"relative",background:"#efefef",width:s/l*400,height:400,marginLeft:"auto",marginRight:"auto"},g=[i.a.createElement(Bt,{di:o.list,displayGroups:n,handleClick:()=>{},selectable:!0}),i.a.createElement("div",{style:u},c.map(e=>i.a.createElement(ft.a,{key:e.name,style:Wt,default:{width:400*e.width,height:400*e.height,x:400*e.left,y:400*e.top},bounds:"parent",lockAspectRatio:!0,onDragStop:(t,a)=>{d(e,c,a.x,a.y,void 0,void 0,400)},onResizeStop:(t,a,n,i,o)=>{d(e,c,o.x,o.y,Ft(n.style.width),Ft(n.style.height),400)}},i.a.createElement("div",{className:t.trHandle}),i.a.createElement("div",{className:t.tlHandle}),i.a.createElement("div",{className:t.brHandle}),i.a.createElement("div",{className:t.blHandle}),e.name)))];return i.a.createElement("div",null,i.a.createElement("button",{type:"button",onClick:this.handleOpen,className:t.button,style:a.button},i.a.createElement("i",{className:"icon-open-add",style:{paddingLeft:2,lineHeight:"45px"}},i.a.createElement(ht.a,{className:t.badge,classes:{badge:t.badgeCircle},badgeContent:r.length}))),i.a.createElement(Ze.a,{open:h,className:"trelliscope-app",style:{zIndex:8e3,fontWeight:300},onBackdropClick:this.handleClose,"aria-labelledby":"dialog-reldisp-title",maxWidth:"md",fullWidth:!0},i.a.createElement(Xe.a,{id:"dialog-reldisp-title"},"View Related Displays Simultaneously"),i.a.createElement(et.a,null,i.a.createElement("div",null,i.a.createElement(ct.a,{alternativeLabel:!0,nonLinear:!0,activeStep:m},i.a.createElement(dt.a,null,i.a.createElement(pt.a,{onClick:()=>this.setStep(0)},"Select related displays (".concat(r.length," selected)"))),i.a.createElement(dt.a,null,i.a.createElement(pt.a,{onClick:()=>this.setStep(1),disabled:0===m&&0===r.length},"Arrange Panel Layout"))),i.a.createElement("div",null,g[m]))),i.a.createElement(tt.a,null,i.a.createElement("div",{style:{textAlign:"center",width:"100%"}},i.a.createElement(at.a,{style:{width:200},onClick:()=>this.setStep(1===m?0:1),className:t.button,disabled:0===m&&0===r.length},0===m?"":i.a.createElement(ut.a,null),0===m?"Set Layout":"Select Displays",0===m?i.a.createElement(bt.a,null):"")),i.a.createElement(at.a,{color:"secondary",onClick:this.handleClose},"Close"))))}}const Mt={button:{position:"absolute",boxSizing:"border-box",top:-1,transition:"left 0.5s ease, background 250ms",display:"inline-block",height:nt.header.height,width:nt.header.height,fontSize:18,textAlign:"center",borderRight:"1px solid ".concat(nt.header.borderColor),borderBottom:"1px solid ".concat(nt.header.borderColor),borderLeft:"none",borderTop:"none","&:hover":{transition:"background 250ms",background:"#eee",cursor:"pointer"}},trHandle:{position:"absolute",top:0,right:0,width:8,height:8,background:"rgba(69, 138, 249, 0.4)"},tlHandle:{position:"absolute",top:0,left:0,width:8,height:8,background:"rgba(69, 138, 249, 0.4)"},brHandle:{position:"absolute",bottom:0,right:0,width:8,height:8,background:"rgba(69, 138, 249, 0.4)"},blHandle:{position:"absolute",bottom:0,left:0,width:8,height:8,background:"rgba(69, 138, 249, 0.4)"},badge:{paddingBottom:27},badgeCircle:{background:"rgba(69, 138, 249, 0.4)",color:"white"}},Ut=Object(oe.a)(le,re,Ot,At,Rt,Ct,e=>e.relDispPositions,(e,t,a,n,i,o,l)=>({styles:{button:{left:nt.header.height*(""===t.name||0===Object.keys(a).length?0:2)-1,background:0===o.length?"none":"rgba(69, 138, 249, 0.4)",color:0===o.length?nt.header.button.color:"white"}},displayList:e,relatedDisplayGroups:a,active:Object.keys(a).length>0,contentHeight:n,contentWidth:i,selectedRelDisps:o,relDispPositions:l}));var Vt=Object(s.b)(e=>Ut(e),e=>({handleResize:(t,a,n,i,o,l,s)=>{const r=a.map(e=>e.name).indexOf(t.name),c=Object(Te.a)({},t);c.left=n/s,c.top=i/s,o&&(c.width=o/s),l&&(c.height=l/s);const d=Object(Te.a)({},a);d[r]=c,e(J(d))}}))(Object(Ye.a)(Mt)(Ht)),Gt=a(30),Kt=a.n(Gt),Yt=a(31);class qt extends i.a.Component{constructor(e){super(e),this.handleOpen=()=>{const e=this.props,t=e.displayList,a=e.setDialogOpen,n=e.setDispDialogOpen;t&&t.isLoaded&&(a(!0),n(!0),Qe.a.bind("esc",this.handleClose))},this.handleKey=()=>{const e=this.props,t=e.setDialogOpen,a=e.setDispDialogOpen;t(!0),a(!0),Qe.a.bind("esc",this.handleClose)},this.handleClose=()=>{const e=this.props,t=e.setDialogOpen,a=e.setDispDialogOpen;t(!1),a(!1),Qe.a.unbind("esc")},this.handleSelect=(e,t,a)=>{const n=this.props,i=n.handleClick,o=n.setDialogOpen,l=n.setDispDialogOpen;i(e,t,a,n.cfg,n.appId),o(!1),l(!1)},this.state={btnScale:1}}componentDidMount(){const e=this.props,t=e.fullscreen,a=e.selectedDisplay,n=this.state.btnScale;t&&Qe.a.bind("o",this.handleKey);const i=setInterval(()=>{const e=this._atnnCircle;""!==a.name&&clearInterval(i),e&&(e.style.transform="scale(".concat(n,")"),this.setState({btnScale:1===n?.85:1}))},750)}UNSAFE_componentWillReceiveProps(e){e.fullscreen?Qe.a.bind("o",this.handleKey):Qe.a.unbind("o")}componentWillUnmount(){this.props.fullscreen&&Qe.a.unbind("o")}render(){const e=this.props,t=e.classes,a=e.displayList,n=e.displayGroups,o=e.selectedDisplay,l=e.isOpen,s=a&&a.isLoaded;let r=i.a.createElement("div",{className:t.attnOuter},i.a.createElement("div",{className:t.attnInner},i.a.createElement("div",{ref:e=>{this._atnnCircle=e},className:t.attnEmpty})));return(""!==o.name||l)&&(r=""),i.a.createElement("div",null,i.a.createElement("button",{type:"button",onClick:this.handleOpen,className:Kt()({[t.button]:!0,[t.buttonInactive]:!s})},r,i.a.createElement("i",{className:"icon-folder-open ".concat(t.folderIcon)})),i.a.createElement(Ze.a,{open:l,className:"trelliscope-app",style:{zIndex:8e3,fontWeight:300},"aria-labelledby":"dialog-dispselect-title",onBackdropClick:this.handleClose,disableEscapeKeyDown:!0,maxWidth:"md",fullWidth:!0},i.a.createElement(Xe.a,{id:"dialog-dispselect-title"},"Select a Display to Open"),i.a.createElement(et.a,null,i.a.createElement(Bt,{di:a.list,displayGroups:n,handleClick:this.handleSelect,selectable:!1})),i.a.createElement(tt.a,null,i.a.createElement(at.a,{color:"secondary",onClick:this.handleClose},"Close"))))}}const Qt={attnOuter:{position:"absolute",overflow:"hidden",height:nt.header.height,width:nt.header.height,top:0,left:(nt.sideButtons.width-nt.header.height)/2,pointerEvents:"none"},attnInner:{position:"absolute",height:nt.header.height,width:nt.header.height,top:0,left:0,transition:["transform 450ms cubic-bezier(0.23, 1, 0.32, 1)","0ms opacity 450ms cubic-bezier(0.23, 1, 0.32, 1) 0ms"].join(" "),opacity:1,transform:"scale(0.85)"},attnEmpty:{position:"absolute",height:nt.header.height,width:"100%",borderRadius:"50%",opacity:.16,transition:"transform 750ms cubic-bezier(0.445, 0.05, 0.55, 0.95) 0ms",top:0,transform:"scale(0.85)",backgroundColor:"rgba(0, 0, 0, 0.870588)"},folderIcon:{paddingLeft:3},button:{zIndex:8e3,position:"absolute",boxSizing:"border-box",top:-1,left:-1,height:nt.header.height,width:nt.sideButtons.width,fontSize:18,lineHeight:"".concat(nt.header.height+2,"px"),background:nt.header.button.active.background,color:"white",textAlign:"center",border:"none",transition:"all 500ms ease-in","&:hover":{transition:"background 250ms",background:Object(Yt.emphasize)(nt.header.button.active.background,.2),color:"white",cursor:"pointer"}},buttonInactive:{background:"#ddd",borderColor:"#ddd","&:hover":{background:"#ccc",borderColor:"#ccc"}}},Jt=Object(oe.a)(re,le,kt,fe,ve,ye,we,e=>e.dispSelectDialog,(e,t,a,n,i,o,l,s)=>({appId:i,cfg:n,selectedDisplay:e,displayList:t,displayGroups:a,singlePageApp:o,fullscreen:l,isOpen:s}));var $t=Object(s.b)(e=>Jt(e),e=>({handleClick:(t,a,n,i,o)=>{var l;e(B("")),e({type:"SET_SELECTED_RELDISPS",which:"reset",val:l}),e(U([])),e(M({nrow:1,ncol:1,arrange:"row"})),e(M({pageNum:1})),e(K({active:[],inactive:[]})),e(G({})),e(V([])),e(J([])),e(q(t,a,n)),e(ie(t,a,i,o,""))},setDispDialogOpen:t=>{e(F(t))}}))(Object(Ye.a)(Qt)(qt)),Xt=a(205),Zt=a(131),ea=a.n(Zt),ta=a(132),aa=a.n(ta);class na extends i.a.Component{constructor(...e){super(...e),this.pageLeft=()=>{const e=this.props;let t=e.n-1;return t<1&&(t+=1),(0,e.handleChange)(t)},this.pageRight=()=>{const e=this.props;let t=e.n+1;return t>e.totPages&&(t-=1),(0,e.handleChange)(t)},this.pageFirst=()=>{(0,this.props.handleChange)(1)},this.pageLast=()=>{const e=this.props;(0,e.handleChange)(e.totPages)}}componentDidMount(){const e=this.props,t=e.fullscreen,a=e.dialogOpen;t&&(Qe.a.bind("right",()=>{a||this.pageRight()}),Qe.a.bind("left",()=>{a||this.pageLeft()}))}UNSAFE_componentWillReceiveProps(e){const t=e.dialogOpen;e.fullscreen?(Qe.a.bind("right",()=>{t||this.pageRight()}),Qe.a.bind("left",()=>{t||this.pageLeft()})):Qe.a.unbind(["right","left"])}componentWillUnmount(){this.props.fullscreen&&Qe.a.unbind(["right","left"])}render(){const e=this.props,t=e.classes,a=e.cogData,n=e.totPages,o=e.totPanels,l=e.npp,s=e.n,r={icon:{fontSize:10,padding:6},button:{width:nt.header.height-10,height:nt.header.height-10,border:0,padding:0},progress:{width:120,fontSize:14,color:"#444",lineHeight:"48px"}};if(a.isFetching||a.isLoaded&&void 0===a.crossfilter)return i.a.createElement("div",{style:r.progress},"loading panels...");if(0===o)return i.a.createElement("div",null);const c=l*(s-1)+1,d=Math.min(l*s,o);let p=i.a.createElement("span",null,c);c!==d&&(p=i.a.createElement("span",null,c,"\xa0",i.a.createElement("span",{className:t.pageDash},"-"),"\xa0",d));const h=i.a.createElement("span",null,p,i.a.createElement("span",null," of ".concat(o)));return i.a.createElement("div",{className:t.outer},i.a.createElement("div",{className:t.label},h),i.a.createElement("div",{className:t.buttonWrap},i.a.createElement("div",{className:t.buttonDiv},i.a.createElement(Xt.a,{disabled:s<=1,style:r.button,onClick:()=>this.pageFirst()},i.a.createElement(ea.a,null))),i.a.createElement("div",{className:t.buttonText},"First")),i.a.createElement("div",{className:t.buttonWrap},i.a.createElement("div",{className:t.buttonDiv},i.a.createElement(Xt.a,{disabled:s<=1,style:r.button,onClick:()=>this.pageLeft()},i.a.createElement(ut.a,null))),i.a.createElement("div",{className:t.buttonText},"Prev")),i.a.createElement("div",{className:t.buttonWrap},i.a.createElement("div",{className:t.buttonDiv},i.a.createElement(Xt.a,{disabled:s>=n,style:r.button,onClick:()=>this.pageRight()},i.a.createElement(bt.a,null))),i.a.createElement("div",{className:t.buttonText},"Next")),i.a.createElement("div",{className:t.buttonWrap},i.a.createElement("div",{className:t.buttonDiv},i.a.createElement(Xt.a,{disabled:s>=n,style:r.button,onClick:()=>this.pageLast()},i.a.createElement(aa.a,null))),i.a.createElement("div",{className:t.buttonText},"Last")))}}const ia={outer:{whiteSpace:"nowrap"},buttonWrap:{width:nt.header.height-10,height:nt.header.height,display:"inline-block"},buttonDiv:{width:nt.header.height-10,height:nt.header.height-10,paddingLeft:5},buttonText:{fontSize:10,width:48,height:10,lineHeight:"10px",textAlign:"center",marginTop:-5},pageDash:{display:"inline-block",transform:"scale(1.5,1)"},label:{verticalAlign:"middle",height:nt.header.height,display:"inline-block"}},oa=Object(oe.a)(de,Oe,pe,Ee,we,ce,(e,t,a,n,i,o)=>({n:e,totPanels:t,totPages:Math.ceil(t/a),npp:a,dialogOpen:n,fullscreen:i,cogData:o}));var la=Object(s.b)(e=>oa(e),e=>({handleChange:t=>{e(M({pageNum:t}))}}))(Object(Ye.a)(ia)(na)),sa=a(285),ra=a(271);class ca extends i.a.Component{constructor(e){super(e),this.handleOpen=()=>{(0,this.props.setDialogOpen)(!0),this.setState({open:!0}),Qe.a.bind("esc",this.handleClose)},this.handleChange=(e,t)=>{this.setState({value:t})},this.handleKey=()=>{(0,this.props.setDialogOpen)(!0),this.setState({open:!0}),Qe.a.bind("esc",this.handleClose)},this.handleClose=()=>{(0,this.props.setDialogOpen)(!1),this.setState({open:!1}),Qe.a.unbind("esc")},this.state={open:!1,value:0}}componentDidMount(){this.props.fullscreen&&Qe.a.bind("a",this.handleKey)}UNSAFE_componentWillReceiveProps(e){e.fullscreen?Qe.a.bind("a",this.handleKey):Qe.a.unbind("a")}componentWillUnmount(){this.props.fullscreen&&Qe.a.unbind("a")}render(){const e=this.props,t=e.classes,a=e.fullscreen,n=e.windowHeight;let o="";a||(o=i.a.createElement("p",{className:t.keynote},"Note: keyboard shortcuts are only available when the app is fullscreen."));const l=i.a.createElement("div",{className:t.dialogDiv,style:{maxHeight:Math.max(50,n-310)}},i.a.createElement("div",{className:t.dialogP},i.a.createElement("strong",null,"What: "),"Trelliscope is a tool for interactively viewing a large collection of visualizations.  Each visualization in a collection is called a\xa0",i.a.createElement("em",null,"panel"),"\xa0and each panel typically represents one slice of a large dataset."),i.a.createElement("div",{className:t.dialogP},i.a.createElement("strong",null,"Why: "),"Viewing multiple slices of a dataset simultaneously is a simple  but very powerful visual technique and provides a way to visualize data in greater detail, particularly when the dataset is large."),i.a.createElement("div",{className:t.dialogP},i.a.createElement("strong",null,"Interactivity: "),"When there are many panels, it is useful to be able to navigate to which panels you want to view and make panel-to-panel comparisons by sorting and filtering the panels based on various criteria. Trelliscope provides this interactivity through panel metrics called\xa0",i.a.createElement("em",null,"cognostics"),"."),i.a.createElement("p",null,"There are multiple modes of interaction with panels, indicated by the four buttons on the left sidebar of the application: \xa0",i.a.createElement("strong",null,"Grid"),",\xa0",i.a.createElement("strong",null,"Labels"),",\xa0",i.a.createElement("strong",null,"Filter"),",\xa0and\xa0",i.a.createElement("strong",null,"Sort"),"."),i.a.createElement("div",{className:t.dialogP},i.a.createElement("i",{className:"icon-th ".concat(t.dialogHi)}),"\xa0",i.a.createElement("strong",null,"Grid: "),'In the "Grid" sidebar, you can specify the layout of the grid of panels you wish to display, specifying the number of rows and columns of the grid, as well as whether to arrange panels in order by row or by column.'),i.a.createElement("div",{className:t.dialogP},i.a.createElement("i",{className:"icon-list-ul ".concat(t.dialogHi)}),"\xa0",i.a.createElement("strong",null,"Labels: "),'In the "Labels" sidebar, you can specify the panel metrics that you wish to see displayed under each panel visualization in the grid by clicking the checkboxes.  This can be useful for additional context along with the visualization being shown.  Note that labels can also be removed by directly hovering over the label in the grid view and clicking the "x" button that appears.  Labels are also automatically added when you specify a new variable to sort or filter on.'),i.a.createElement("div",{className:t.dialogP},i.a.createElement("i",{className:"icon-filter ".concat(t.dialogHi)}),"\xa0",i.a.createElement("strong",null,"Filter: "),'The "Filter" sidebar provides various ways to filter the panels being displayed based on the panel metrics. A list of variables is available as buttons.  Clicking a button will produce a visual distribution of the variable.',i.a.createElement("p",{className:t.dialogP2},i.a.createElement("strong",null,"Categorical filter: "),"For categorical variables, a bar chart is provided, showing the the possible values of the variable with the size of the bars relating to the count of panels available under the current filtering state of all other variables. A bar is active if its color is highlighted.  The bar chart shows active bars first followed by inactive bars. Clicking on a bar in this chart that is not active will cause only panels with the attribute of the clicked bar to be shown. Clicking on a bar that is active will remove panels with the attribute of the clicked bar from view.  Another way to specify filtering for categorical variables is to enter text into the text field below the bar chart.  Any matches to the typed text will be highlighted in the bar chart and panels will be filtered accordingly.  This field can be plain text or a\xa0",i.a.createElement("a",{href:"http://regexr.com/",target:"_blank",rel:"noopener noreferrer"},"regular expression"),"."),i.a.createElement("p",{className:t.dialogP2},i.a.createElement("strong",null,"Numeric filter: "),"For numeric variables, a histogram is provided, which shows the distribution of the variable based on all other active filters. You can click and drag left to right to highlight a range of the variable for which you would like to filter the panels. Alternatively, you can manually enter a range in the fields provided below the histogram."),i.a.createElement("p",{className:t.dialogP22},"To reset a filter variable, you can either clear out the fields, deselect the selections made in the distribution plots, or click the\xa0",i.a.createElement("i",{className:"icon-undo"}),"\xa0button located at the top right of the filter box for that variable.  This icon is only available if there is an active filter for the variable."),i.a.createElement("p",{className:t.dialogP22},"To close a filter box, click the\xa0",i.a.createElement("i",{className:"icon-times-circle"}),'\xa0button located at the top right of the filter box.  Note that if there is an active filter on the variable, its button in the "More variables" section will be green to indicate this.')),i.a.createElement("div",{className:t.dialogP},i.a.createElement("i",{className:"icon-sort-amount-asc ".concat(t.dialogHi)}),"\xa0",i.a.createElement("strong",null,"Sort: "),'In the "Sort" sidebar, a list of variables which are currently being sorted by (if any) will be listed at the top, followed by a list of "More variables" that can added to the sorting specification.  Panels are ordered primarily according to the topmost sort variable, and any subsuequent sorting variables specify secondary, tertiary, etc. sorting. For an active sortig variable, clicking the blue icon with an arrow pointing up or down will change the order of the sorting.'),i.a.createElement("div",{className:t.dialogP},"The active filter and sort state are displayed at the bottom of the page in the footer.  Clicking the\xa0",i.a.createElement("i",{className:"icon-times-circle"}),"\xa0button for anything listed in the footer will remove the sorting or filtering on that variable.")),s=i.a.createElement("div",{className:t.dialogDiv},i.a.createElement("div",null,o,i.a.createElement("div",{style:{width:"50%",display:"block",float:"left"}},i.a.createElement("h4",{className:t.dialogH4},"Sidebar controls"),i.a.createElement("ul",{className:t.dialogUl},i.a.createElement("li",null,i.a.createElement("code",{className:t.dialogCode},"g"),'\u2002open "Grid" sidebar'),i.a.createElement("li",null,i.a.createElement("code",{className:t.dialogCode},"l"),'\u2002open "Labels" sidebar'),i.a.createElement("li",null,i.a.createElement("code",{className:t.dialogCode},"f"),'\u2002open "Filter" sidebar'),i.a.createElement("li",null,i.a.createElement("code",{className:t.dialogCode},"s"),'\u2002open "Sort" sidebar'),i.a.createElement("li",null,i.a.createElement("code",{className:t.dialogCode},"esc"),"\u2002close sidebar")),i.a.createElement("h4",{className:t.dialogH4},"Panel navigation"),i.a.createElement("ul",{className:t.dialogUl},i.a.createElement("li",null,i.a.createElement("code",{className:t.dialogCode},"left"),"\u2002page back"),i.a.createElement("li",null,i.a.createElement("code",{className:t.dialogCode},"right"),"\u2002page forward"))),i.a.createElement("div",{style:{width:"50%",display:"block",float:"left"}},i.a.createElement("h4",{className:t.dialogH4},"Dialog boxes"),i.a.createElement("ul",{className:t.dialogUl},i.a.createElement("li",null,i.a.createElement("code",{className:t.dialogCode},"i"),'\u2002open "Display Info" dialog'),i.a.createElement("li",null,i.a.createElement("code",{className:t.dialogCode},"a"),'\u2002open "About" dialog'),i.a.createElement("li",null,i.a.createElement("code",{className:t.dialogCode},"esc"),"\u2002close dialog")),i.a.createElement("h4",{className:t.dialogH4},"Touchscreen devices"),i.a.createElement("p",{className:t.dialogUl},"Swiping left and right will page the panels forward and backward")))),r=i.a.createElement("div",{className:t.dialogDiv},i.a.createElement("p",null,"\xa9\xa0",i.a.createElement("a",{href:"http://ryanhafen.com",target:"_blank",rel:"noopener noreferrer"},"Ryan Hafen"),", 2019."),i.a.createElement("p",null,"Built with\xa0",i.a.createElement("a",{href:"https://facebook.github.io/react/",target:"_blank",rel:"noopener noreferrer"},"React"),"\xa0and several other awesome libraries listed\xa0",i.a.createElement("a",{href:"https://github.com/hafen/trelliscopejs-lib/blob/master/package.json",target:"_blank",rel:"noopener noreferrer"},"here"),"."),i.a.createElement("p",null,"Source code available on\xa0",i.a.createElement("a",{href:"https://github.com/hafen/trelliscopejs-lib/",target:"_blank",rel:"noopener noreferrer"},"github"),"\xa0\u2013 submit issues and feature requests there."),i.a.createElement("p",null,"Thanks to Bill Cleveland for ideas upon which this is built, to Saptarshi Guha for creating a multi-panel plot viewer prototype many years ago that inspired initial work, and to Barret Schloerke for the introduction to React and discussions about the interface.")),c=this.state,d=c.open,p=c.value;return i.a.createElement("div",null,i.a.createElement("button",{type:"button",onClick:this.handleOpen,className:t.logo},"Trelliscope",i.a.createElement("div",{className:t.icon},i.a.createElement("i",{className:"icon-help ".concat(t.icon)}))),i.a.createElement(Ze.a,{open:d,className:"trelliscope-app",style:{zIndex:8e3,fontWeight:300},"aria-labelledby":"dialog-viewer-title",onBackdropClick:this.handleClose},i.a.createElement(Xe.a,{id:"dialog-viewer-title"},"Trelliscope Viewer v".concat("0.3.4")),i.a.createElement(et.a,null,i.a.createElement(sa.a,{value:p,onChange:this.handleChange},i.a.createElement(ra.a,{label:"How to Use"}),i.a.createElement(ra.a,{label:"Shortcuts"}),i.a.createElement(ra.a,{label:"Credits"})),0===p&&l,1===p&&s,2===p&&r),i.a.createElement(tt.a,null,i.a.createElement(at.a,{color:"secondary",onClick:this.handleClose},"Close"))))}}const da={logo:{position:"absolute",top:-1,right:0,cursor:"pointer",border:"none",height:nt.header.height,textAlign:"center",width:nt.header.logoWidth,fontSize:17,background:nt.header.logo.background,color:nt.header.logo.color},icon:{position:"absolute",top:1,right:1,color:Object(Yt.emphasize)(nt.header.logo.background,.4)},dialogHeadline:{fontSize:24,paddingTop:16,marginBottom:12,fontWeight:400},dialogDiv:{fontSize:18,paddingLeft:10,paddingRight:10,zIndex:5e3},dialogH4:{marginBottom:5},dialogUl:{marginTop:0,breakInside:"avoid-column"},dialogCode:{color:"#FF5252",fontSize:20},dialogP:{textIndent:-20,paddingLeft:20,marginTop:"1em"},dialogP2:{paddingLeft:20},dialogP22:{textIndent:0,paddingLeft:20},dialogHi:{color:"#FF5252"},keynote:{marginBottom:0,color:"#888",fontStyle:"italic"}},pa=Object(oe.a)(Dt,we,(e,t)=>({windowHeight:e,fullscreen:t}));var ha=Object(s.b)(e=>pa(e))(Object(Ye.a)(da)(ca));class ma extends i.a.Component{constructor(e){super(e),this.state={singleLoaded:""!==e.selectedDisplay.name,singleDisplay:e.displayList.isLoaded&&e.displayList.list.length<=1}}UNSAFE_componentWillReceiveProps(e){const t=this.state.singleLoaded,a=e.displayList.isLoaded&&e.displayList.list.length<=1;this.setState({singleDisplay:a}),!t&&a&&""!==e.selectedDisplay.name?this.setState({singleLoaded:!0}):!t&&a&&(e.selectDisplay(e.displayList.list[0].name,e.displayList.list[0].group,e.displayList.list[0].desc,e.cfg,e.appId,window.location.hash),this.setState({singleLoaded:!0}))}render(){const e=this.props,t=e.classes,a=e.styles,n=e.displayList,o=e.selectedDisplay,l=e.relatedDisplayGroups,s=e.displayGroups,r=e.doSetDialogOpen,c=e.dialogOpen,d=this.state.singleDisplay;let p="",h="",m={visibility:"hidden"},u="",g="",b="";l&&Object.keys(l).length>0&&(b=i.a.createElement(Vt,{setDialogOpen:r}));const f=""!==o.name,v=Object.keys(s).length;return n.isLoaded&&!d&&(g=i.a.createElement($t,{setDialogOpen:r})),f?(p=v>1?"".concat(o.group," /\n          ").concat(o.name):o.name.replace(/_/g," "),d||(m={color:"#aaa",fontSize:12}),h=o.desc,u=i.a.createElement(la,null)):d?p="loading...":!c&&n.list.length>0&&(p=i.a.createElement("span",null,i.a.createElement("i",{className:"icon-arrow-left"}),"\xa0select a display to view...")),i.a.createElement("div",{className:t.headerContainer,style:a.headerContainer},g,b,i.a.createElement(rt,{singleDisplay:d,setDialogOpen:r}),i.a.createElement("i",{style:m,className:"fa fa-info-circle"}),i.a.createElement("div",{className:t.headerSubContainer,style:a.headerSubContainer},i.a.createElement("div",{className:t.nameDescContainer},i.a.createElement("div",{className:t.displayName,style:a.displayName},p),i.a.createElement("div",{className:t.displayDesc},h)),i.a.createElement("div",{className:t.paginationContainer},u)),i.a.createElement(ha,{setDialogOpen:r,singleDisplay:d}))}}const ua={headerContainer:{position:"absolute",boxSizing:"border-box",top:0,left:0,height:nt.header.height,background:nt.header.background,color:nt.header.color,borderBottom:"1px solid ".concat(nt.header.borderColor),borderTop:"1px solid ".concat(nt.header.borderColor),borderLeft:"1px solid ".concat(nt.header.borderColor),margin:0,fontSize:nt.header.fontSize,fontWeight:300,zIndex:1010},headerSubContainer:{display:"flex",position:"absolute",top:0,height:nt.header.height},nameDescContainer:{flex:"1 0",minWidth:0,whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},paginationContainer:{},displayName:{verticalAlign:"top",paddingLeft:15,fontSize:17,whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},displayDesc:{verticalAlign:"top",fontWeight:300,paddingLeft:15,paddingRight:8,fontSize:10,fontStyle:"italic",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"}},ga=Object(oe.a)(ve,Nt,le,kt,re,Ot,fe,Ee,(e,t,a,n,i,o,l,s)=>({styles:{headerContainer:{width:t},headerSubContainer:{left:nt.header.height*((a.list.length<=1?0:1)+(""===i.name?0:1)+(0===Object.keys(o).length?0:1)),width:t-(nt.header.height*((a.list.length<=1?0:1)+(""===i.name?0:1)+(0===Object.keys(o).length?0:1))+nt.header.logoWidth+30)},displayName:{lineHeight:"".concat(""===i.desc?48:26,"px"),paddingTop:""===i.desc?0:5}},appId:e,cfg:l,displayList:a,displayGroups:n,selectedDisplay:i,relatedDisplayGroups:o,dialogOpen:s}));var ba=Object(s.b)(e=>ga(e),e=>({selectDisplay:(t,a,n,i,o,l)=>{e(q(t,a,n)),e(ie(t,a,i,o,l))},doSetDialogOpen:t=>{e(W(t))}}))(Object(Ye.a)(ua)(ma));a(193);const fa={base:{position:"relative",width:nt.sideButtons.width,height:nt.sideButtons.width,lineHeight:"".concat(nt.sideButtons.width,"px"),textAlign:"center",verticalAlign:"middle",fontSize:nt.sideButtons.fontSize,color:nt.sideButtons.button.color,borderBottom:"1px solid ".concat(nt.sideButtons.button.borderColor),borderTop:"none",borderLeft:"none",borderRight:"none",userSelect:"none",background:nt.sideButtons.background,transition:"color 0.2s, background 0.2s","&:hover":{transition:"color 0.2s, background 0.2s",background:nt.sideButtons.button.hover.background,cursor:"pointer"}},active:{transition:"color 0.2s, background 0.2s",background:"white",color:nt.sideButtons.button.active.color,"&:hover":{transition:"color 0.2s, background 0.2s",background:nt.sideButtons.button.active.background}},icon:{lineHeight:"".concat(nt.sideButtons.fontSize,"px"),height:nt.sideButtons.fontSize,width:nt.sideButtons.width,position:"absolute",top:8,left:0},label:{fontSize:nt.sideButtons.labelFontSize,lineHeight:"".concat(nt.sideButtons.labelFontSize,"px"),width:nt.sideButtons.width,position:"absolute",bottom:4,left:0},bottom:{position:"absolute",bottom:0,left:0,borderTop:"1px solid",borderBottom:"0px"}};var va=Object(Ye.a)(fa)(({classes:e,isActive:t,icon:a,title:n,label:o,onClick:l})=>i.a.createElement("button",{className:Kt()({[e.base]:!0,[e.active]:t,[e.bottom]:"Configuration"===n}),type:"button",onClick:l},i.a.createElement("div",{className:e.icon},i.a.createElement("i",{className:a})),i.a.createElement("div",{className:e.label},o)));const ya=[{icon:"icon-th",label:"Grid",title:"Panel Grid Layout",key:"g"},{icon:"icon-list-ul",label:"Labels",title:"Show/Hide Labels",key:"l"},{icon:"icon-filter",label:"Filter",title:"Filter Panels",key:"f"},{icon:"icon-sort-amount-asc",label:"Sort",title:"Sort Panels",key:"s"},{icon:"icon-views",label:"Views",title:"Views",key:"v"}];class wa extends i.a.Component{constructor(e){super(e),this.handleKey=(e,t)=>{const a=this.props,n=a.dialogOpen,i=a.setActive,o=a.hasViews;if("v"!==t||o)if("INPUT"===e.target.nodeName||n)e.stopPropagation();else if("esc"===t||"enter"===t)i("");else{const e=[];for(let a=0;a<ya.length;a+=1)ya[a].key===t&&e.push(ya[a].title);e.length>0&&i(e[0])}},this.state={}}componentDidMount(){const e=this.props,t=e.fullscreen,a=e.active;t&&(Qe.a.bind(["g","l","f","s","c","v","enter"],this.handleKey),""!==a&&Qe.a.bindGlobal("esc",this.handleKey))}UNSAFE_componentWillReceiveProps(e){e.fullscreen?(Qe.a.bind(["g","l","f","s","c","v","enter"],this.handleKey),""!==e.active&&Qe.a.bindGlobal("esc",this.handleKey)):Qe.a.unbind(["g","l","f","s","c","v","esc","enter"])}componentWillUnmount(){this.props.fullscreen&&Qe.a.unbind(["g","l","f","s","c","v","esc","enter"])}render(){const e=this.props,t=e.classes,a=e.styles,n=e.active,o=e.hasViews,l=e.setActive;return i.a.createElement("div",{className:t.sideButtonsContainer,style:a.sideButtonsContainer},i.a.createElement("div",{className:t.spacer}),ya.map(e=>"Views"!==e.label||o?i.a.createElement(va,{key:"sidebutton_".concat(e.title),isActive:e.title===n,icon:e.icon,title:e.title,label:e.label,onClick:()=>l(e.title)}):""))}}const Ea={sideButtonsContainer:{position:"absolute",left:0,top:0,paddingTop:nt.header.height,width:nt.sideButtons.width,background:nt.sideButtons.background,boxSizing:"border-box",zIndex:1e3},spacer:{transition:"height 0.2s",height:nt.sidebar.header.height,width:nt.sideButtons.width,background:nt.sideButtons.spacerBackground}},xa=Object(oe.a)(At,jt,Ee,we,se,(e,t,a,n,i)=>({styles:{sideButtonsContainer:{height:e+nt.header.height}},width:nt.sideButtons.width,active:t,dialogOpen:a,fullscreen:n,hasViews:i.info&&i.info.views&&i.info.views.length>0||!1}));var Sa=Object(s.b)(e=>xa(e),e=>({setActive:t=>{e(B(t))}}))(Object(Ye.a)(Ea)(wa)),_a=a(272),Oa=a(206),Ca=a(273);const Ia=Object(oe.a)(At,be,se,(e,t,a)=>({width:nt.sidebar.width,height:e-nt.sidebar.header.height,labels:t,cogInfo:a.info.cogInfo}));var ka=Object(s.b)(e=>Ia(e),e=>({handleChange:(t,a)=>{const n=a.indexOf(t);-1===n?a.push(t):a.splice(n,1),e(U(a))}}))(Object(Ye.a)({rowDesc:{color:"#888",fontStyle:"italic"}})(({height:e,labels:t,cogInfo:a,handleChange:n})=>{let o=i.a.createElement("div",null);const l=Object.keys(a);if(l.length>0){const s=l.map(e=>({name:a[e].name,desc:a[e].desc}));o=i.a.createElement("div",{style:{height:e,overflowY:"auto",overflowX:"hidden"}},i.a.createElement(_a.a,{style:{padding:0}},s.map(e=>i.a.createElement(Oa.a,{key:e.name,dense:!0,button:!0,onClick:()=>n(e.name,t)},i.a.createElement(xt.a,{checked:-1!==t.indexOf(e.name),style:{width:20,height:20},tabIndex:-1,disableRipple:!0}),i.a.createElement(Ca.a,{primary:e.name,secondary:e.desc,style:{whiteSpace:"nowrap",textOverflow:"ellipsis"}})))))}return o})),Na=a(286),Da=a(291),ja=a(275),Ta=a(274);class La extends i.a.Component{constructor(e){super(e),this.increment=()=>{const e=this.state,t=e.value,a=e.step,n=this.props,i=n.max,o=n.onChange,l=t+a;i&&l>i||(this.setState({value:l}),o&&o(l))},this.decrement=()=>{const e=this.state,t=e.value,a=e.step,n=this.props,i=n.min,o=n.onChange,l=t-a;i&&l<i||(this.setState({value:l}),o&&o(l))},this.handleChange=e=>{const t=this.props,a=t.min,n=t.max,i=t.onChange;this.setState({value:e.target.value});const o=parseFloat(e.target.value);if(!Number.isNaN(o)&&i){let e=!0;a&&o<a&&(e=!1),n&&o>n&&(e=!1),e&&i(o)}};let t=1;e.step&&(t=e.step),this.state={value:e.value,step:t},this.mousetrap=null}componentDidMount(){this.mousetrap=new Qe.a(this._NumericInput),this.mousetrap.bind("up",()=>this.increment()),this.mousetrap.bind("down",()=>this.decrement()),this.mousetrap.bind("esc",()=>(this._NumericInput.blur(),!1)),this.mousetrap.bind(["left","right","g","l","s","f","c","a","i","o","r"],e=>e.stopPropagation())}UNSAFE_componentWillReceiveProps(e){this.setState({value:e.value})}componentWillUnmount(){this.mousetrap.unbind("up"),this.mousetrap.unbind("down"),this.mousetrap.unbind("esc"),this.mousetrap.unbind(["left","right","g","l","s","f","c","a","i","o","r"])}render(){const e=this.props,t=e.classes,a=e.arrows,n=e.size,o=this.state.value;let l="";return a&&(l=i.a.createElement("span",null,i.a.createElement("button",{type:"button",key:"up-button",className:"".concat(t.b," ").concat(t.b1),onClick:this.increment,tabIndex:"-1"},i.a.createElement("i",{className:"".concat(t.i," ").concat(t.i1)})),i.a.createElement("button",{type:"button",key:"down-button",className:"".concat(t.b," ").concat(t.b2),onClick:this.decrement,tabIndex:"-1"},i.a.createElement("i",{className:"".concat(t.i," ").concat(t.i2)})))),i.a.createElement("span",{className:t.span},i.a.createElement("input",{ref:e=>{this._NumericInput=e},type:"text",size:n||4,className:"mousetrap ".concat(t.input),value:o,onChange:this.handleChange}),l)}}const Ra={span:{position:"relative",display:"inline-block",borderRadius:0,fontSize:13},input:{padding:"3px 10px 3px 6px",boxSizing:"border-box",height:28,width:"auto",fontSize:15,borderRadius:2,fontFamily:nt.fontFamily,border:"1px solid rgb(204, 204, 204)",display:"block",lineHeight:"normal"},b:{position:"absolute",right:2,width:15,borderColor:"rgba(0, 0, 0, 0.0980392)",borderStyle:"solid",textAlign:"center",cursor:"pointer",transition:"all 0.1s",boxShadow:"none","&:hover":{background:"rgba(0, 0, 0, 0.2)",boxShadow:"0 0 0 0.5px rgba(0, 0, 0, 0.3)"}},b1:{top:2,bottom:"50%",borderRadius:"2px 2px 0px 0px",borderWidth:"1px 1px 0px",background:"rgba(0, 0, 0, 0.0980392)",height:12},b2:{top:"50%",bottom:2,borderRadius:"0px 0px 2px 2px",borderWidth:"0px 1px 1px",background:"rgba(0, 0, 0, 0.0980392)",height:12},i:{position:"absolute",top:"50%",left:"50%",width:0,height:0},i1:{borderWidth:"0px 0.6ex 0.6ex",borderColor:"transparent transparent rgba(0, 0, 0, 0.701961)",borderStyle:"solid",margin:"-0.3ex 0px 0px -0.56ex"},i2:{borderWidth:"0.6ex 0.6ex 0px",borderColor:"rgba(0, 0, 0, 0.701961) transparent transparent",borderStyle:"solid",margin:"-0.3ex 0px 0px -0.56ex"}};var Aa=Object(Ye.a)(Ra)(La);const Pa={row:{paddingLeft:15,paddingRight:15,paddingTop:8,paddingBottom:6,height:42,boxSizing:"border-box",fontSize:16,width:nt.sidebar.width,display:"inline-block"},label:{lineHeight:"28px",float:"left"},nInput:{float:"right"},inputRadio:{marginBottom:5,marginTop:0},inputLabelSpan:{lineHeight:"40px",verticalAlign:"middle",fontSize:16},inputIcon:{fontSize:23,paddingLeft:6,verticalAlign:"text-bottom"},relDisp:{fontSize:14,padding:15},relDispText:{paddingBottom:10},relDispButton:{textAlign:"center"}},za=Object(oe.a)(ge,e=>e.selectedRelDisps,(e,t)=>({layout:e,hasRelDisps:t.length>0}));var Ba=Object(s.b)(e=>za(e),e=>({handleChange:t=>{e(M(t))},resetRelDisps:()=>{e(Q([])),e(J([]))}}))(Object(Ye.a)(Pa)(({classes:e,layout:t,hasRelDisps:a,handleChange:n,resetRelDisps:o})=>{let l=i.a.createElement("div",null);return a?l=i.a.createElement("div",{className:e.relDisp},i.a.createElement("div",{className:e.relDispText},"Grid layout cannot be changed when viewing related displays."),i.a.createElement("div",{className:e.relDispButton},i.a.createElement(at.a,{variant:"outlined",color:"primary",onClick:o,size:"small"},"Remove Related Displays"))):t.nrow&&(l=i.a.createElement("div",null,i.a.createElement("div",{className:e.row},i.a.createElement("div",{className:e.label},"Rows:"),i.a.createElement("div",{className:e.nInput},i.a.createElement(Aa,{arrows:!0,value:t.nrow,size:3,min:1,max:15,step:1,onChange:e=>n({nrow:e,ncol:t.ncol,arrange:t.arrange})}))),i.a.createElement(Ta.a,null),i.a.createElement("div",{className:e.row},i.a.createElement("div",{className:e.label},"Columns:"),i.a.createElement("div",{className:e.nInput},i.a.createElement(Aa,{arrows:!0,value:t.ncol,size:3,min:1,max:15,step:1,onChange:e=>n({nrow:t.nrow,ncol:e,arrange:t.arrange})}))),i.a.createElement(Ta.a,null),i.a.createElement("div",{className:e.row},"Arrangement:"),i.a.createElement("div",{className:e.row},i.a.createElement(Da.a,{name:"arrangement",value:t.arrange,onChange:(e,a)=>n({nrow:t.nrow,ncol:t.ncol,arrange:a})},i.a.createElement(ja.a,{value:"row",control:i.a.createElement(Na.a,null),label:i.a.createElement("span",{className:e.inputLabelSpan},"By row",i.a.createElement("i",{className:"icon-byrow ".concat(e.inputIcon)})),className:e.inputRadio}),i.a.createElement(ja.a,{value:"column",control:i.a.createElement(Na.a,null),label:i.a.createElement("span",{className:e.inputLabelSpan},"By column",i.a.createElement("i",{className:"icon-bycol ".concat(e.inputIcon)})),className:e.inputRadio}))))),l})),Wa=a(59),Fa=a(276);const Ha={tableWrap:{overflowY:"auto",overflowX:"hidden"},table:{width:nt.sidebar.width-5,borderCollapse:"collapse",borderSpacing:0,tableLayout:"fixed"},tr:{width:nt.sidebar.width-5,height:48,borderBottom:"1px solid rgb(224, 224, 224)"},sortButton:{verticalAlign:"middle",width:45,textAlign:"center"},labels:{fontSize:13,height:48,width:nt.sidebar.width-45-45-5,verticalAlign:"middle",overflow:"hidden",whiteSpace:"nowrap",textOverflow:"ellipsis"},closeButton:{height:48,width:45,textAlign:"center",verticalAlign:"middle"},notUsedHeader:{height:30,lineHeight:"30px",paddingLeft:10,boxSizing:"border-box",width:nt.sidebar.width,fontSize:14},notUsed:{width:nt.sidebar.width,overflowY:"auto",boxSizing:"border-box",paddingLeft:10,paddingRight:10,paddingBottom:10},variable:{display:"inline-block",boxShadow:"rgba(0, 0, 0, 0.117647) 0px 1px 6px, rgba(0, 0, 0, 0.117647) 0px 1px 4px",borderRadius:10,border:0,background:"none",paddingTop:"2px !important",paddingBottom:"3px !important",paddingLeft:"7px !important",paddingRight:"7px !important",margin:"3px !important",fontSize:12,color:"black",cursor:"pointer",transition:"all 450ms cubic-bezier(0.23, 1, 0.32, 1) 0ms","&:hover":{transition:"all 450ms cubic-bezier(0.23, 1, 0.32, 1) 0ms",background:"#ebebeb"}}},Ma=Object(oe.a)(se,e=>{const t={},a=Object.keys(e.info.cogInfo);for(let n=0;n<a.length;n+=1)t[a[n]]=e.info.cogInfo[a[n]].desc;return t}),Ua=Object(oe.a)(ue,Ma,Tt,be,(e,t,a,n)=>{const i=51*e.length>a-102;let o=51*e.length;if(i){o=51*Math.ceil(.6*a/51)-25}return{styles:{tableWrap:{maxHeight:o},notUsed:{height:a-o-30}},sort:e,cogDesc:t,labels:n}});var Va=Object(s.b)(e=>Ua(e),e=>({handleChange:t=>{e(V(t)),e(M({pageNum:1}))},addLabel:(t,a)=>{if(a.indexOf(t)<0){const n=Object.assign([],a);n.push(t),e(U(n))}}}))(Object(Ye.a)(Ha)(({classes:e,styles:t,sort:a,cogDesc:n,labels:o,handleChange:l,addLabel:s})=>{let r=i.a.createElement("div",null);if(n){const c=Object.keys(n);for(let e=0;e<a.length;e+=1){const t=c.indexOf(a[e].name);t>-1&&c.splice(t,1)}r=i.a.createElement("div",null,i.a.createElement("div",{className:e.tableWrap,style:t.tableWrap},i.a.createElement("table",{className:e.table},i.a.createElement("tbody",null,a.map((t,o)=>{const s="asc"===t.dir?"up":"down";return i.a.createElement("tr",{className:e.tr,key:"".concat(t.name,"_tr")},i.a.createElement("td",{className:e.sortButton},i.a.createElement(Xt.a,{color:"primary",key:"".concat(t.name,"_button"),onClick:()=>{const e=Object.assign([],a);e[o].dir="asc"===e[o].dir?"desc":"asc",l(e)}},i.a.createElement("i",{className:"icon-chevron-".concat(s),style:{fontSize:16}}))),i.a.createElement("td",{className:e.labels},t.name,i.a.createElement("br",null),i.a.createElement("span",{style:{color:"#888",fontStyle:"italic"}},n[t.name])),i.a.createElement("td",{className:e.closeButton},i.a.createElement(Xt.a,{onClick:()=>l(o)},i.a.createElement(Fa.a,{className:"icon-times",style:{fontSize:16,color:"#aaa"}}))))})))),i.a.createElement("div",{className:e.notUsedHeader},0===a.length?"Select a variable to sort on:":0===c.length?"":"More variables:"),i.a.createElement("div",{className:e.notUsed,style:t.notUsed},c.map(t=>i.a.createElement("span",{key:"".concat(t,"_notused")},i.a.createElement("span",{"data-tip":!0,"data-for":"tooltip_".concat(t)},i.a.createElement("button",{type:"button",className:e.variable,key:"".concat(t,"_button"),onClick:()=>{const e=Object.assign([],a);e.push({name:t,dir:"asc"}),s(t,o),l(e)}},t)),i.a.createElement(Wa.a,{place:"right",id:"tooltip_".concat(t)},i.a.createElement("span",null,n[t]))))))}return r})),Ga=a(133),Ka=a.n(Ga),Ya=a(152),qa=a(278),Qa=a(284),Ja=a(136),$a=a.n(Ja),Xa=a(146);class Za extends i.a.Component{constructor(e){super(e),this.mouseOver=()=>{this.setState({hover:!0})},this.mouseOut=()=>{this.setState({hover:!1})},this.state={hover:!1}}render(){const e=this.props,t=e.classes,a=e.width,n=e.height,o=e.d,l=e.divStyle,s=e.handleClick,r=e.active,c=e.allActive,d=this.state.hover,p=Math.min(10,n-6),h=Math.min(9,n-7),m=o.ct===o.mct?o.mct:"".concat(o.ct," / ").concat(o.mct);return i.a.createElement("div",{className:Kt()({[t.wrapper]:!0,[t.wrapperHover]:d}),style:l,onMouseOver:this.mouseOver,onFocus:this.mouseOver,onMouseOut:this.mouseOut,onBlur:this.mouseOut,onClick:s},i.a.createElement("div",{className:Kt()({[t.bar]:!0,[t.barHover]:d,[t.barActive]:r&&!d,[t.barAllActive]:c&&!d}),style:{width:a,height:n-1}},i.a.createElement("div",{className:t.barText,style:{fontSize:p,lineHeight:"".concat(n-1,"px"),width:a}},i.a.createElement("div",{className:t.barTextInner},o.id))),i.a.createElement("div",{className:Kt()({[t.barLabel]:!0,[t.hidden]:!d}),style:{labelFontSize:h,lineHeight:"".concat(n-1,"px")}},m))}}const en={wrapper:{background:"white"},wrapperHover:{background:"#f6f6f6"},bar:{background:nt.sidebar.filter.cat.bar.color.default,color:nt.sidebar.filter.cat.text.color.default,position:"absolute",left:0},barHover:{background:nt.sidebar.filter.cat.bar.color.hover,color:nt.sidebar.filter.cat.text.color.hover},barActive:{background:nt.sidebar.filter.cat.bar.color.select,color:nt.sidebar.filter.cat.text.color.select},barAllActive:{background:nt.sidebar.filter.cat.bar.color.noneSelect,color:nt.sidebar.filter.cat.text.color.select},barLabel:{fontSize:10,color:"#444",textAlign:"center",cursor:"default",position:"absolute",lineHeight:"19px",right:4},hidden:{visibility:"hidden"},barText:{display:"inline-block",overflow:"hidden",cursor:"default"},barTextInner:{display:"inline-block",whiteSpace:"nowrap",position:"absolute",left:5,bottom:0}};var tn=Object(Ye.a)(en)(Za);class an extends i.a.Component{constructor(...e){super(...e),this.barCellRenderer=e=>{const t=this.props,a=t.condDist,n=t.sortOrder,o=t.filterState,l=t.cellHeight,s=t.width,r=t.dist;let c=0,d=0,p="",h=0,m=!0;const u=a.totSelected;let g;return g=e.rowIndex<u?a.reverseRows?e.rowIndex:u-(e.rowIndex+1):a.reverseRows?e.rowIndex:a.dist.length-(e.rowIndex-u+1),g=a.idx[g],m=e.rowIndex<u,c=a.dist[g].value,d=c,p=a.dist[g].key,h=a.max,i.a.createElement(tn,{key:"".concat(e.rowIndex,"_").concat(d,"_").concat(n),style:null,divStyle:e.style,active:m,allActive:void 0===o.value,height:l,width:c/h*(s-1)+1,handleClick:()=>this.handleSelect(p,m),d:{ct:d,mct:r.dist[p],id:p}})}}handleSelect(e,t){const a=this.props,n=a.filterState,i=a.sortOrder,o=a.handleChange,l=Object.assign([],n.value);if(t){const t=l.indexOf(e);t>-1&&l.splice(t,1)}else l.push(e);let s={};s=0===l.length?{name:n.name,varType:n.varType,orderValue:i}:{name:n.name,type:"select",varType:n.varType,value:l,orderValue:i},o(s)}render(){const e=this.props,t=e.condDist,a=e.filterCardinality,n=e.width,o=e.height,l=e.cellHeight,s=t.orderValue,r=t.totSelected,c=t.sumSelected,d=a;return i.a.createElement(Xa.a,{key:"".concat(s,"_").concat(r,"_").concat(c,"_").concat(d),width:n,height:o,columnWidth:n,rowHeight:l,columnCount:1,rowCount:t.dist.length,cellRenderer:this.barCellRenderer})}}const nn=Object(oe.a)(Oe,e=>({filterCardinality:e}));var on=Object(s.b)(e=>nn(e))(an);const ln=[{payload:"ct,asc",text:"Order: count ascending"},{payload:"ct,desc",text:"Order: count descending"},{payload:"id,asc",text:"Order: label ascending"},{payload:"id,desc",text:"Order: label descending"}];class sn extends i.a.Component{constructor(e){super(e),this.handleMenuClose=()=>{this.setState({menuOpen:!1})},this.handleMenuIconClick=e=>{const t=this.state.menuOpen;this.setState({menuOpen:!t}),this.setState({anchorEl:t?null:e.currentTarget})};const t=this.props.filterState;this.sortOrder=t.orderValue?t.orderValue:"ct,desc",this.state={menuOpen:!1,anchorEl:null}}UNSAFE_componentWillUpdate(){const e=this.props.filterState;this.sortOrder=e.orderValue?e.orderValue:"ct,desc"}handleRegex(e){const t=this.props,a=t.filterState,n=t.levels,i=t.handleChange;let o={};if(""===e)o={name:a.name,varType:a.varType,orderValue:this.sortOrder};else{const t=[],i=new RegExp(e,"i");n.forEach(e=>{null!==e.match(i)&&t.push(e)}),o={name:a.name,type:"regex",varType:a.varType,regex:e,value:t,orderValue:this.sortOrder}}i(o)}render(){const e=this.props,t=e.classes,a=e.handleSortChange,n=e.filterState,o=e.height,l=e.dist,s=e.condDist,r=e.handleChange,c={width:nt.sidebar.width-40,marginTop:-8,fontSize:16,transform:"scale(0.85)",transformOrigin:"0 0"},d=this.state,p=d.menuOpen,h=d.anchorEl,m=i.a.createElement("div",{className:t.extraOptionsInput},i.a.createElement(Xt.a,{"aria-label":"more","aria-controls":"long-menu","aria-haspopup":"true",onClick:this.handleMenuIconClick},i.a.createElement($a.a,null)),i.a.createElement(Ya.a,{id:"long-menu",open:p,anchorEl:h,onClose:this.handleMenuClose},ln.map(e=>i.a.createElement(qa.a,{key:e.payload,selected:e.payload===n.orderValue,onClick:()=>{a(Object.assign(n,{orderValue:e.payload})),this.handleMenuClose()}},e.text))));return i.a.createElement("div",{className:t.container},i.a.createElement("div",{className:t.plotContainer},i.a.createElement(on,{className:t.plotContainer,height:o,width:nt.sidebar.width-2*nt.sidebar.filter.margin,cellHeight:15,dist:l,condDist:s,filterState:n,handleChange:r,sortOrder:this.sortOrder})),i.a.createElement("div",{className:t.inputContainer},i.a.createElement(Qa.a,{placeholder:"regex",style:c,value:"regex"===n.type?n.regex:"",onChange:e=>this.handleRegex(e.target.value)}),m))}}const rn={container:{width:nt.sidebar.width-2*nt.sidebar.filter.margin,boxSizing:"border-box",paddingLeft:nt.sidebar.filter.margin,paddingRight:nt.sidebar.filter.margin,paddingTop:nt.sidebar.filter.margin},plotContainer:{width:nt.sidebar.width-2*nt.sidebar.filter.margin,boxSizing:"border-box",position:"relative",overflow:"hidden",cursor:"default",userSelect:"none",zIndex:1e3},inputContainer:{height:39,width:nt.sidebar.width-2*nt.sidebar.filter.margin,marginBottom:-21,paddingTop:7,zIndex:100,position:"relative"},extraOptionsInput:{float:"right",marginTop:-6,width:28,transform:"scale(0.6)",transformOrigin:"0 0"}};var cn=Object(Ye.a)(rn)(sn),dn=a(42),pn=a(283),hn=a(150),mn=a(279),un=a(96),gn=a(99);const bn={};class fn extends i.a.Component{componentDidMount(){const e=this.props,t=e.condDist,a=e.width,n=e.height,i=t.delta,o=[t.breaks[0],t.breaks[t.breaks.length-1]+i],l=Object(pn.a)().domain(o).range([5,a-5]),s=Object(pn.a)().domain([0,t.max]).range([n-16,0]),r=Object(hn.a)(s).scale(l).ticks(5).tickSize(4),c=n-16,d=l(i)-l(0);this.d3pars={axisPad:16,sidePad:5,delta:i,xrange:o,xs:l,ys:s,axis:r,height:c,barWidth:d,barPath:(e,t)=>{const a=[];let n=0;const i=e.length;let o,l;for(;n<i;)o=e[n],l=0===o.value?t.ys(o.value):t.ys(o.value)-1,a.push("M",t.xs(o.key)+1,",",t.height,"V",l,"h",t.barWidth-1,"V",t.height),n+=1;return a.join("")}},this._d3node.call(bn.enter.bind(this,this.props,this.d3pars))}componentDidUpdate(){const e=this.props.condDist;this.d3pars.ys.domain([0,e.max]),this._d3node.call(bn.update.bind(this,this.props,this.d3pars))}render(){const e=this.props,t=e.width,a=e.height;return i.a.createElement("svg",{ref:e=>{this._d3node=Object(mn.a)(e)},width:t,height:a})}}var vn=fn;bn.enter=(e,t,a)=>{const n=Object(gn.a)().extent([[t.sidePad,1],[e.width-t.sidePad,t.height+1]]).handleSize(10);n.on("brush",()=>{const e=un.c.selection;a.select("#cliprect").attr("x",e[0]).attr("width",e[1]-e[0])}).on("end",()=>{if(un.c.sourceEvent)if(un.c.selection){const a=un.c.selection.map(e=>(e=>{const t=Math.max(Math.floor(Math.log10(Math.abs(e))),5);return parseFloat(e.toPrecision(t))})(t.xs.invert(e)));e.handleChange(a)}else a.select("#cliprect").attr("x",t.xs(t.xrange[0])).attr("width",t.xs(t.xrange[1])-t.xs(t.xrange[0])),e.handleChange(void 0)});const i=a.append("g"),o=Object.assign([],t.xrange);e.filterState.value&&(e.filterState.value.from&&(o[0]=e.filterState.value.from),e.filterState.value.to&&(o[1]=e.filterState.value.to)),i.append("clipPath").attr("id","clip-".concat(e.name)).append("rect").attr("id","cliprect").attr("x",t.xs(o[0])).attr("width",t.xs(o[1])-t.xs(o[0])).attr("height",e.height-t.axisPad),i.append("path").attr("class","bar background").datum(e.condDist.dist).attr("fill","#ddd"),i.append("path").attr("class","bar foreground").datum(e.condDist.dist).attr("clip-path","url(#clip-".concat(e.name,")")),e.filterState.value?i.selectAll(".foreground").attr("fill","rgb(255, 170, 10)"):i.selectAll(".foreground").attr("fill","rgb(255, 210, 127)");const l=a.append("g").attr("class","axis").attr("transform","translate(0,".concat(e.height-t.axisPad+1,")")).call(t.axis);l.select("path").attr("fill","none").attr("stroke","#000").attr("stroke-opacity",.4).attr("shape-rendering","crispEdges"),l.selectAll(".tick").attr("opacity",.4);const s=i.append("g").attr("class","brush").call(n);e.filterState.value&&s.call(n.move,[t.xs(o[0]),t.xs(o[1])]),s.select("rect.selection").attr("fill","rgb(255, 210, 127)").attr("fill-opacity","0.125").attr("stroke","rgb(255, 170, 10)").attr("stroke-opacity","0.2"),s.selectAll("rect").attr("height",t.height),a.selectAll(".bar").attr("d",e=>t.barPath(e,t))},bn.update=(e,t,a)=>{if(a.selectAll(".bar").attr("d",null).datum(e.condDist.dist).attr("d",e=>t.barPath(e,t)),void 0!==e.filterState.value){let n=e.filterState.value.from,i=e.filterState.value.to;void 0===n&&(n=t.xrange[0]),void 0===i&&(i=t.xrange[1]),i>n&&(a.select(".brush").call(Object(gn.a)().move,[t.xs(n),t.xs(i)]),a.select("#cliprect").attr("x",t.xs(n)).attr("width",t.xs(i)-t.xs(n)),a.selectAll("path.foreground").attr("fill","rgb(255, 170, 10)"))}else a.select(".brush").call(Object(gn.a)().move,null),a.selectAll("path.foreground").attr("fill","rgb(255, 210, 127)"),a.select("#cliprect").attr("x",t.xs(t.xrange[0])).attr("width",t.xs(t.xrange[1])-t.xs(t.xrange[0]))};class yn extends i.a.Component{constructor(e){super(e),this.stateValue={},this.handleBrushInput=this.handleBrushInput.bind(this)}componentDidUpdate(){void 0===this.props.filterState.value&&this._fromInput&&this._toInput&&(this._fromInput.input.value=null,this._toInput.input.value=null)}setValidState(e,t,a){const n=this.props,i=n.filterState,o=n.handleChange,l=this.checkValidNumber(e,t,a);void 0!==i.valid&&i.valid===l||o(Object.assign(i,{valid:l}))}handleInput(e,t){const a=this.props,n=a.filterState,i=a.handleChange;let o={};const l=""===e?void 0:parseFloat(e),s="from"===t?l:this.stateValue.from,r="to"===t?l:this.stateValue.to;o=void 0===s&&void 0===r?{name:n.name,type:"range",varType:n.varType,valid:!0}:{name:n.name,type:"range",varType:n.varType,value:{from:s,to:r},valid:this.checkValidNumber(s,r,t)},i(o)}handleBrushInput(e){const t=this.props,a=t.filterState,n=t.handleChange;if(void 0===e){n({name:a.name,type:"range",varType:a.varType,valid:!0}),this._fromInput&&this._toInput&&(this._fromInput.input.value=null,this._toInput.input.value=null)}else{if(n({name:a.name,type:"range",varType:a.varType,value:{from:e[0],to:e[1]},valid:!0}),this._fromInput&&this._toInput){var i=Object(dn.a)(e,2);this._fromInput.input.value=i[0],this._toInput.input.value=i[1]}}}checkValidNumber(e,t,a){if("to"===a){if(e&&parseFloat(e)>parseFloat(t))return!1}else if(t&&parseFloat(t)<parseFloat(e))return!1;return!0}render(){const e=this.props,t=e.classes,a=e.filterState,n=e.dist,o=e.condDist,l=e.name,s={textAlign:"center"};void 0===a.valid||a.valid||(s.color="red");const r={width:75,marginTop:-5,fontSize:16,transform:"scale(0.85)",transformOrigin:"0 0"},c={textAlign:"center",paddingBottom:2};this.stateValue=a.value,void 0===this.stateValue&&(this.stateValue={});const d=this.stateValue,p=d.to,h=d.from;p&&h&&p<h&&(c.color="red");const m=n.dist.raw.breaks,u=(m[1]-m[0])*m.length,g=Math.pow(10,Math.round(Math.log10(u/100)-.4));return i.a.createElement("div",{className:t.container},i.a.createElement("div",{className:t.plotContainer},i.a.createElement(vn,{name:l,className:t.plotContainer,width:nt.sidebar.width-2*nt.sidebar.filter.margin,height:nt.sidebar.filter.num.height,dist:n,condDist:o,filterState:a,handleChange:this.handleBrushInput})),i.a.createElement("div",{className:t.inputContainer},i.a.createElement("div",{className:t.rangeInputText},"Range:"),i.a.createElement(Qa.a,{name:"fromText",style:r,inputProps:{style:c},type:"number",step:g,value:this.stateValue.from?this.stateValue.from:"",onChange:e=>this.handleInput(e.target.value,"from")}),i.a.createElement("div",{className:"".concat(t.rangeInputText," ").concat(t.rangeInputTextDash)},"-"),i.a.createElement(Qa.a,{name:"toText",style:r,inputProps:{style:c},type:"number",step:g,value:this.stateValue.to?this.stateValue.to:"",onChange:e=>this.handleInput(e.target.value,"to")})))}}const wn={container:{marginLeft:5,marginRight:5,marginTop:5},plotContainer:{width:nt.sidebar.width-2*nt.sidebar.filter.margin,height:nt.sidebar.filter.num.height,position:"relative",overflow:"hidden",cursor:"default",userSelect:"none",zIndex:1e3},inputContainer:{width:nt.sidebar.width-2*nt.sidebar.filter.margin,marginBottom:-12,paddingBottom:8,paddingTop:4,zIndex:100,position:"relative",verticalAlign:"center"},rangeInputText:{fontSize:13,paddingRight:10,display:"inline-block"},rangeInputTextDash:{paddingLeft:4,transform:"scale(2,1)"}};var En=Object(Ye.a)(wn)(yn);const xn={col1:{position:"absolute",top:nt.sidebar.header.height,left:0},col2:{position:"absolute",top:nt.sidebar.header.height,left:nt.sidebar.width,borderLeft:"1px solid ".concat(nt.sidebar.borderColor)},notUsedHeader:{height:30,lineHeight:"30px",paddingLeft:10,boxSizing:"border-box",width:nt.sidebar.width,fontSize:14},notUsedContainer:{width:nt.sidebar.width,overflowY:"auto",boxSizing:"border-box",paddingLeft:10,paddingRight:10,paddingBottom:10},variable:{display:"inline-block",boxShadow:"rgba(0, 0, 0, 0.117647) 0px 1px 6px, rgba(0, 0, 0, 0.117647) 0px 1px 4px",borderRadius:10,paddingTop:"2px !important",paddingBottom:"3px !important",paddingLeft:"7px !important",paddingRight:"7px !important",border:0,background:"white",margin:"3px !important",fontSize:12,cursor:"pointer",color:"black",transition:"all 450ms cubic-bezier(0.23, 1, 0.32, 1) 0ms","&:hover":{transition:"all 450ms cubic-bezier(0.23, 1, 0.32, 1) 0ms",background:"#ebebeb"}},variableActive:{background:"#81C784",color:"white","&:hover":{background:Object(Yt.emphasize)("#81C784",.2)}},allContainer:{width:nt.sidebar.width,boxSizing:"border-box"},container:{width:nt.sidebar.width,boxSizing:"border-box",zIndex:100,position:"relative",paddingBottom:6,borderBottom:"1px solid ".concat(nt.sidebar.borderColor)},header:{height:16,lineHeight:"15px",width:nt.sidebar.width,marginTop:1,fontSize:12,position:"relative"},headerExtra:{position:"absolute",right:38,height:16,lineHeight:"15px",fontSize:11,color:"#777"},headerName:{height:16,paddingLeft:5,paddingRight:5,position:"absolute",left:1,userSelect:"none",cursor:"default",background:"#999"},headerNameActive:{background:"#81C784"},headerNameText:{color:"white"},headerIcon:{height:16,color:"#666",cursor:"pointer",position:"absolute",border:"none",background:"none",marginTop:-1,padding:0,zIndex:1e3,"&:hover":{transition:"all 150ms cubic-bezier(0.23, 1, 0.32, 1) 0ms",color:"#aaa"}},headerIconHide:{visibility:"hidden"},headerClose:{right:5},headerReset:{right:18}},Sn=Object(oe.a)(he,me,It,Tt,se,Se,Lt,be,(e,t,a,n,i,o,l,s)=>({styles:{col1:{height:n},col2:{height:n,display:null===l.cutoff?"none":"inline"},notUsedContainer:{height:n-35-l.heights[null===l.cutoff?0:1]},allContainer:{height:n}},catHeight:nt.sidebar.filter.cat.height,filter:e,filterView:t,cogInfo:a,curDisplayInfo:i,filtDist:o,colSplit:l,labels:s}));var _n=Object(s.b)(e=>Sn(e),e=>({handleViewChange:(t,a,n)=>{if("add"===a&&n.indexOf(t)<0){const a=Object.assign([],n);a.push(t),e(U(a))}e(K(t,a))},handleFilterChange:t=>{let a;"string"===typeof t||t instanceof String?a=t:(a={},a[t.name]=Object(Te.a)({},t)),e(G(a)),e(M({pageNum:1}))},handleFilterSortChange:t=>{const a={};a[t.name]=t,e(G(a))}}))(Object(Ye.a)(xn)(({classes:e,styles:t,catHeight:a,filter:n,filterView:o,cogInfo:l,curDisplayInfo:s,filtDist:r,colSplit:c,handleViewChange:d,handleFilterChange:p,handleFilterSortChange:h,labels:m})=>{let u=i.a.createElement("div",null);const g=s.info.name;if(n&&o.active&&c){let b=[],f=[];null===c.cutoff?b=o.active:(b=o.active.slice(0,c.cutoff),f=o.active.slice(c.cutoff,o.active.length));const v=[b,f].map(t=>t.map((t,o)=>{if(r[t]){let o=n[t],c="";const m=o&&void 0!==o.value;let u=i.a.createElement("div",{key:"".concat(t,"_").concat(g)},t);if("factor"===l[t].type||"time"===l[t].type||"date"===l[t].type){o||(o={name:t,orderValue:"ct,desc",type:"select",varType:"factor"});const e=l[t].levels?l[t].levels.length:1e3;u=i.a.createElement(cn,{filterState:o,height:Math.min(a,15*e),dist:s.info.cogDistns[t],condDist:r[t],levels:s.info.cogInfo[t].levels,handleChange:p,handleSortChange:h}),c="".concat(r[t].totSelected," of ").concat(r[t].dist.length)}else"numeric"===l[t].type&&(o||(o={name:t,orderValue:"ct,desc",type:"range",varType:"numeric"}),u=i.a.createElement(En,{name:t,filterState:o,dist:s.info.cogDistns[t],condDist:r[t],handleChange:p}));return i.a.createElement("div",{key:"".concat(t,"_").concat(g),className:e.container},i.a.createElement("div",{className:e.header},i.a.createElement("div",{className:Kt()({[e.headerName]:!0,[e.headerNameActive]:m})},i.a.createElement("span",{"data-tip":!0,"data-for":"hdtooltip_".concat(t)},i.a.createElement("span",{className:e.headerNameText},t))),i.a.createElement(Wa.a,{place:"right",id:"hdtooltip_".concat(t)},i.a.createElement("span",null,l[t].desc)),i.a.createElement("div",{className:e.headerExtra},c),i.a.createElement("button",{type:"button",key:"".concat(t,"_").concat(g,"-close-icon"),className:"".concat(e.headerIcon," ").concat(e.headerClose),onMouseDown:()=>d(t,"remove")},i.a.createElement("i",{className:"icon-times-circle"})),i.a.createElement("button",{type:"button",key:"".concat(t,"_").concat(g,"-reset-icon"),className:Kt()({[e.headerIcon]:!0,[e.headerReset]:!0,[e.headerIconHide]:!m}),onMouseDown:()=>p(o.name)},i.a.createElement("i",{className:"icon-undo"}))),u)}return""})),y=null===c.cutoff?0:1,w=Object.keys(l),E=Ka()(w,o.inactive);t.notUsedContainer.height<170&&1===y?v[y].push(i.a.createElement("div",{key:"notUsedHeader",className:e.notUsedHeader},"Remove filters to select more.")):(v[y].push(i.a.createElement("div",{key:"notUsedHeader",className:e.notUsedHeader},0===o.active.length?"Select a variable to filter on:":0===o.inactive.length?"":"More variables:")),v[y].push(i.a.createElement("div",{key:"notUsed",className:e.notUsedContainer,style:t.notUsedContainer},E.map(t=>i.a.createElement("span",{key:"".concat(t,"_").concat(g)},i.a.createElement("span",{"data-tip":!0,"data-for":"tooltip_".concat(t)},i.a.createElement("button",{type:"button",className:Kt()({[e.variable]:!0,[e.variableActive]:n[t]&&void 0!==n[t].value}),key:"".concat(t,"_").concat(g,"_button_").concat(E.length),onClick:()=>d(t,"add",m)},t)),i.a.createElement(Wa.a,{place:"right",id:"tooltip_".concat(t)},i.a.createElement("span",null,l[t].desc))))))),u=i.a.createElement("div",{className:e.allContainer,style:t.allContainer},i.a.createElement("div",{className:e.col1,style:t.col1},v[0]),i.a.createElement("div",{className:e.col2,style:t.col2},v[1]))}return u}));const On=Object(oe.a)(At,se,It,(e,t,a)=>({width:nt.sidebar.width,height:e-nt.sidebar.header.height,views:t.info.views,cinfo:a}));var Cn=Object(s.b)(e=>On(e),e=>({handleChange:(t,a)=>{const n={};if(t.replace("#","").split("&").forEach(e=>{const t=e.split("=");n[t[0]]=t[[1]]}),n.nrow&&n.ncol&&n.arr){const t={nrow:parseInt(n.nrow,10),ncol:parseInt(n.ncol,10),arrange:n.arr};e(M(t))}if(n.pg&&e(M({pageNum:parseInt(n.pg,10)})),n.labels){const t=n.labels.split(",");e(U(t))}let i=[];n.sort&&(i=n.sort.split(",").map((e,t)=>{const a=e.split(";");return{order:t+1,name:a[0],dir:a[1]}})),e(V(i));const o={};if(n.filter){n.filter.split(",").forEach(e=>{const t={};e.split(";").forEach(e=>{const a=e.split(":");t[a[0]]=a[[1]]});const n={name:t.var,type:t.type,varType:a[t.var].type};if("select"===t.type)n.orderValue="ct,desc",n.value=t.val.split("#").map(decodeURIComponent);else if("regex"===t.type){const e=a[t.var].levels,i=[],o=new RegExp(decodeURIComponent(t.val),"i");e.forEach(e=>{null!==e.match(o)&&i.push(e)}),n.regex=t.val,n.value=i,n.orderValue="ct,desc"}else if("range"===t.type){const e=t.from?parseFloat(t.from,10):void 0,a=t.to?parseFloat(t.to,10):void 0;n.value={from:e,to:a},n.valid=!0,e&&a&&e>a&&(n.valid=!1)}o[t.var]=n})}e(G({})),e(G(o)),n.fv&&n.fv.split(",").map(t=>e(K(t,"add")))}}))(Object(Ye.a)({rowDesc:{color:"#888",fontStyle:"italic"}})(({height:e,views:t,cinfo:a,handleChange:n})=>i.a.createElement("div",{style:{height:e,overflowY:"auto"}},i.a.createElement(_a.a,{style:{padding:0}},t.map(e=>i.a.createElement(Oa.a,{key:e.name,dense:!0,button:!0,onClick:()=>n(e.state,a)},i.a.createElement(Ca.a,{primary:e.name})))))));const In={sidebarContainer:{transitionProperty:"left",transitionDuration:nt.trans.duration,transitionTimingFunction:nt.trans.timing,position:"absolute",left:nt.sideButtons.width,top:nt.header.height,height:"100%",boxSizing:"border-box",borderRight:"1px solid",borderColor:"".concat(nt.sidebar.borderColor," !important"),background:"#fff",zIndex:999,overflow:"hidden"},hidden:{transitionProperty:"left",transitionDuration:nt.trans.duration,transitionTimingFunction:nt.trans.timing,left:nt.sideButtons.width-nt.sidebar.width},header:{paddingLeft:10,boxSizing:"border-box",fontSize:nt.sidebar.header.fontSize,background:nt.sidebar.header.background,height:nt.sidebar.header.height,lineHeight:"".concat(nt.sidebar.header.height,"px"),color:nt.sidebar.header.color,borderLeft:"1px solid #ccc"},empty:{paddingLeft:8,paddingTop:5}},kn=Object(oe.a)(At,jt,e=>!(!e.selectedDisplay||""===e.selectedDisplay.name||!e._displayInfo[e.selectedDisplay.name])&&e._displayInfo[e.selectedDisplay.name].isLoaded,Lt,(e,t,a,n)=>({styles:{sidebarContainer:{width:nt.sidebar.width*(1+("Filter Panels"===t&&n&&null!==n.cutoff)),height:e}},active:t,displayLoaded:a}));var Nn=Object(s.b)(e=>kn(e))(Object(Ye.a)(In)(({classes:e,styles:t,active:a,displayLoaded:n})=>{if(""===a)return i.a.createElement("div",{className:"".concat(e.sidebarContainer," ").concat(e.hidden),style:t.sidebarContainer});let o;if("Configuration"===a)o=i.a.createElement("div",{className:e.empty},"Configuration...");else if(n)switch(a){case"Panel Grid Layout":o=i.a.createElement("div",null,i.a.createElement(Ba,null));break;case"Filter Panels":o=i.a.createElement("div",null,i.a.createElement(_n,null));break;case"Sort Panels":o=i.a.createElement("div",null,i.a.createElement(Va,null));break;case"Show/Hide Labels":o=i.a.createElement("div",null,i.a.createElement(ka,null));break;case"Views":o=i.a.createElement("div",null,i.a.createElement(Cn,null));break;default:o=""}else o=i.a.createElement("div",{className:e.empty},"Load a display...");return i.a.createElement("div",{className:e.sidebarContainer,style:t.sidebarContainer},i.a.createElement("div",{className:e.header},a),o)})),Dn=a(141),jn=a(293),Tn=a(142),Ln=a.n(Tn),Rn=a(277),An=a(143),Pn=a.n(An);class zn extends i.a.Component{constructor(e){super(e),this.myRef=i.a.createRef(),this.isSelfContained=void 0!==e.panelData&&"__self__"===e.cfg.display_base;let t=[e.curDisplayInfo.info.name];e.relDispPositions.length>0&&(t=e.relDispPositions.map(e=>e.name));const a={panels:{},hover:"",textInputOpen:"",textInputValue:"",inputChangeCounter:0};t.forEach(t=>{"image_src"===e.displayInfo[t].info.panelInterface.type?a.panels[t]={panelContent:e.panelRenderers[t].fn(e.displayInfo[t].info.imgSrcLookup[e.panelKey],e.dims.ww,e.dims.hh,!1,e.panelKey),panelData:e.panelData,loaded:!0}:this.isSelfContained?a.panels[t]={panelContent:e.panelRenderers[t].fn(e.panelData,e.dims.ww,e.dims.hh,!1,e.panelKey),panelData:e.panelData,loaded:!0}:a.panels[t]={loaded:!1,panelContent:null,panelData:null}}),this.state=a}componentDidMount(){const e=this.state.panels,t=this.props,a=t.cfg,n=t.panelKey,i=t.panelRenderers,o=t.dims,l=t.curDisplayInfo,s=t.displayInfo,r=t.relDispPositions;let c=[l.info.name];r.length>0&&(c=r.map(e=>e.name)),c.forEach((t,l)=>{const c=i[t],d=s[t].info.cogInterface;let p=o.ww,h=o.hh;if(r.length>0&&(h=o.hh*r[l].height,p=h/r[l].aspect),e[t].loaded)c.fn(e[t].panelData,p,h,!0,"".concat(n,"_").concat(t));else{let e="".concat(a.cog_server.info.base).concat(d.group);e="".concat(e,"/").concat(d.name),window.__panel__||(window.__panel__={}),window.__panel__["_".concat(n,"_").concat(t)]=e=>{const a=this.state.panels;this.setState({panels:Object(Te.a)(Object(Te.a)({},a),{},{[t]:{panelContent:c.fn(e,p,h,!1,"".concat(n,"_").concat(t)),panelData:e,loaded:!0}})})},"jsonp"===a.cog_server.type?this.xhr=I()({url:"".concat(e,"/jsonp/").concat(n,".jsonp"),callbackName:"__panel_".concat(n,"_").concat(t)}):this.xhr=(m={url:"".concat(e,"/json/").concat(n,".json"),callback:window.__panel__["_".concat(n,"_").concat(t)]},Object(S.a)(m.url,e=>m.callback(e)))}var m});const d=this._panel;d.style.opacity=0,setTimeout(()=>d.style.opacity=1,10)}UNSAFE_componentWillReceiveProps(e){const t=this.state.panels,a=Object.keys(t).every(e=>t[e].loaded),n=this.props.dims,i=e.dims.ww!==n.ww,o=e.curDisplayInfo.info.name;if(a&&i)if("image"===e.panelInterface.type){const a=e.panelRenderers[o],n=Object(Te.a)({},t);0===e.relDispPositions.length&&(n[o].panelContent=a.fn(t[o].panelData,e.dims.ww,e.dims.hh,!1,"".concat(e.panelKey,"_").concat(o))),this.setState({panels:n})}else if("htmlwidget"===e.panelInterface.type){const t=k(e.panelInterface.deps.name);if(t){const a=document.getElementById("widget_".concat(e.panelKey));a&&(a.style.width="".concat(e.dims.ww,"px"),a.style.height="".concat(e.dims.hh,"px"),t.resize(a,e.dims.ww,e.dims.hh))}}}componentDidUpdate(){const e=this.state.panels,t=this.props,a=t.panelKey,n=t.panelRenderers,i=t.dims,o=t.curDisplayInfo,l=t.relDispPositions;let s=[o.info.name];l.length>0&&(s=l.map(e=>e.name)),s.forEach((t,o)=>{if(e[t].loaded){let s=i.ww,r=i.hh;l.length>0&&(r=i.hh*l[o].height,s=r/l[o].aspect);n[t].fn(e[t].panelData,s,r,!0,"".concat(a,"_").concat(t))}})}componentWillUnmount(){const e=this.props,t=e.panelKey,a=e.curDisplayInfo.info.name;this.xhr&&this.xhr.abort(),!this.isSelfContained&&window.__panel__&&window.__panel__["_".concat(t,"_").concat(a)]&&(window.__panel__["_".concat(t,"_").concat(a)]=null)}setTextInputOpen(e){this.setState({textInputOpen:e})}handleHover(e){this.setState({hover:e})}render(){const e=this.props,t=e.classes,a=e.dims,n=e.rowIndex,o=e.iColIndex,l=e.labels,s=e.labelArr,r=e.removeLabel,c=e.curDisplayInfo,d=e.relDispPositions,p=e.panelKey,h=this.state,m=h.panels,u=h.hover,g=h.inputChangeCounter,b=h.textInputOpen,f=c.info.name,v=Object.keys(m).every(e=>m[e].loaded);let y=m[f].panelContent;v&&d.length>0&&(y=i.a.createElement("div",null,d.map(e=>i.a.createElement("div",{key:e.name,style:{position:"absolute",top:e.top*a.hh,left:e.left*a.hh,height:e.height*a.hh,width:e.width*a.hh}},m[e.name].panelContent))));const w=d.length>0?a.contentWidth-6:a.ww,E=d.length>0?1:a.pWidth*o+(o+1)*a.pPad+a.wOffset+2*o+1,x={bounding:{width:w+2,height:a.hh+a.nLabels*a.labelHeight+2,top:a.pHeight*n+(n+1)*a.pPad+2*n,right:E},panel:{width:w,height:a.hh},panelContent:{width:w,height:a.hh},labelTable:{width:w},labelRow:{width:w,height:a.labelHeight,lineHeight:"".concat(a.labelHeight,"px")},labelSpan:{fontSize:a.fontSize,position:"absolute"},labelClose:{fontSize:a.fontSize,lineHeight:"".concat(a.labelHeight,"px")},labelInner:{height:a.labelHeight},labelNameCell:{paddingLeft:a.labelPad/2+2,paddingRIght:a.labelPad/2+2,width:a.labelWidth},labelValueCell:{paddingLeft:a.labelPad/2+2,paddingRIght:a.labelPad/2+2},linkIcon:{textDecoration:"none",fontSize:a.fontSize-2},radioDiv:{transform:"scale(".concat(a.labelHeight/29,")"),transformOrigin:"left top",marginTop:-4}};return i.a.createElement("div",{className:t.bounding,style:x.bounding,ref:e=>{this._panel=e}},i.a.createElement("div",{className:t.panel,style:x.panel},v?y:i.a.createElement(Ln.a,{wait:500},i.a.createElement("div",null,"'loading...'"))),i.a.createElement("div",{ref:this.myRef},i.a.createElement("table",{className:t.labelTable,style:x.labelTable},i.a.createElement("tbody",null,l.map((e,n)=>{let o;const l=i.a.createElement("button",{type:"button",className:t.labelClose,style:Object(Te.a)(Object(Te.a)({},x.labelClose),u!==e.name&&{display:"none"}),onClick:()=>r(e.name,s)},i.a.createElement("i",{className:"icon-times-circle"}));if("href"===e.type)o=i.a.createElement("div",{className:t.labelInner,style:x.labelInner},i.a.createElement("a",{style:Object(Te.a)(Object(Te.a)({},x.labelSpan),{},{textDecoration:"none"}),href:e.value,rel:"noopener noreferrer",target:"_blank"},i.a.createElement("i",{className:"icon-open",style:x.linkIcon})));else if("href_hash"===e.type)o=i.a.createElement("div",{className:t.labelInner,style:x.labelInner},i.a.createElement("a",{style:Object(Te.a)(Object(Te.a)({},x.labelSpan),{},{textDecoration:"none"}),href:"#open_in_same_window",onClick:()=>{window.location.href=e.value,window.location.reload()}},i.a.createElement("i",{className:"icon-open",style:x.linkIcon})));else if("input_radio"===e.type){const a=T(c.info,p,e.name),n=c.info.cogInfo[e.name].options;o=i.a.createElement("div",{className:t.labelInner,style:x.labelInner,title:e.value},i.a.createElement("div",{style:x.radioDiv},i.a.createElement(Da.a,{"aria-label":e.name,name:e.name,classes:{root:t.formRow},value:localStorage.getItem(a)||"",onClick:t=>{t.target.value&&(L(c.info,t.target.value,p,e.name),document.activeElement.blur(),this.setState({inputChangeCounter:g+1}))},row:!0},n.map(e=>i.a.createElement(ja.a,{key:e,value:e,control:i.a.createElement(Na.a,{disableRipple:!0,size:"small"}),label:e})))))}else if("input_text"===e.type){const n="".concat(c.info.group,"_:_").concat(c.info.name,"_:_").concat(p,"_:_").concat(e.name),l=i.a.createRef(),s=i.a.createElement("button",{type:"button",className:t.editButton,style:Object(Te.a)({},x.labelClose),onClick:()=>this.setTextInputOpen(e.name)},i.a.createElement(Pn.a,{style:{fontSize:a.fontSize}}));o=i.a.createElement("div",{className:t.labelInner,style:Object(Te.a)(Object(Te.a)({},x.labelInner),{display:"flex",paddingRight:a.fontSize+4}),title:e.value,ref:l},i.a.createElement("div",{className:t.labelP,style:{fontSize:a.fontSize},onClick:()=>this.setTextInputOpen(e.name),role:"button",onKeyDown:()=>{},tabIndex:"-1"},localStorage.getItem(n)||""),i.a.createElement("div",null,s),i.a.createElement(Rn.a,{open:b===e.name,anchorEl:this.myRef.current,onClose:()=>{this.setTextInputOpen(""),L(c.info,this.state.textInputValue,p,e.name),this.setState({inputChangeCounter:g+1})},onEnter:()=>{this.setState({textInputValue:localStorage.getItem(n)||""})},anchorOrigin:{vertical:"top",horizontal:"center"},transformOrigin:{vertical:"top",horizontal:"center"}},i.a.createElement("div",{style:{padding:7}},i.a.createElement(Qa.a,{id:"outlined-multiline-static",label:"".concat(e.name," ('esc' when complete)"),onChange:e=>{this.setState({textInputValue:e.target.value})},value:this.state.textInputValue,style:{minWidth:300},size:"small",autoFocus:!0,multiline:!0,rows:c.info.cogInfo[e.name].height,variant:"outlined"}))))}else o=i.a.createElement("div",{className:t.labelInner,style:x.labelInner,title:e.value},i.a.createElement("span",{className:t.labelP,style:x.labelSpan},e.value));return i.a.createElement("tr",{key:"".concat(e.name),className:Kt()({[t.labelRow]:!0,[t.labelRowHover]:u===e.name}),style:x.labelRow,onMouseOver:()=>this.handleHover(e.name),onFocus:()=>this.handleHover(e.name),onMouseOut:()=>this.handleHover(""),onBlur:()=>this.handleHover("")},i.a.createElement("td",{className:"".concat(t.labelCell," ").concat(t.labelNameCell),style:x.labelNameCell},i.a.createElement("div",{className:t.labelInner,style:x.labelInner,"data-tip":!0,"data-for":"tooltip_".concat(p,"_").concat(e.name)},i.a.createElement("span",{style:x.labelSpan},e.name)),e.name!==e.desc&&i.a.createElement(Wa.a,{place:"right",id:"tooltip_".concat(p,"_").concat(e.name)},i.a.createElement("span",null,e.desc))),i.a.createElement("td",{className:t.labelCell,style:x.labelValueCell},i.a.createElement("div",{className:t.labelOuter},o,l)))})))))}}zn.defaultProps=()=>({panelInterface:void 0,panelData:void 0});const Bn={bounding:{transitionProperty:"all",transitionDuration:nt.trans.duration,transitionTimingFunction:nt.trans.timing,position:"absolute",overflow:"hidden",padding:0,boxSizing:"border-box",border:"1px solid #ddd"},panel:{transitionProperty:"all",transitionDuration:nt.trans.duration,transitionTimingFunction:nt.trans.timing,boxSizing:"border-box",textAlign:"center",overflow:"hidden",color:"#bbb"},panelContent:{transitionProperty:"all",transitionDuration:nt.trans.duration,transitionTimingFunction:nt.trans.timing,display:"block"},labelTable:{transitionProperty:"all",transitionDuration:nt.trans.duration,transitionTimingFunction:nt.trans.timing,padding:0,tableLayout:"fixed",borderSpacing:0,boxSizing:"border-box"},labelRow:{transitionProperty:"all",transitionDuration:nt.trans.duration,transitionTimingFunction:nt.trans.timing,background:"#f6f6f6"},labelRowHover:{background:Object(Yt.fade)("#f6f6f6",.4)},labelCell:{paddingTop:0,paddingBottom:0},labelNameCell:{borderRight:"1px solid #fff",fontWeight:400},labelOuter:{position:"relative",overflow:"hidden"},labelInner:{paddingRight:3,overflow:"hidden",whiteSpace:"normal",verticalAlign:"middle",position:"relative",cursor:"default"},labelP:{overflow:"hidden",whiteSpace:"nowrap",textOverflow:"ellipsis",width:"100%",margin:0},labelClose:{transition:"1s",position:"absolute",top:0,right:2,cursor:"pointer",border:"none",background:"none",padding:0,margin:0,opacity:.5},editButton:{cursor:"pointer",border:"none",background:"none",padding:0,margin:0,opacity:.5},formRow:{flexWrap:"unset"}};var Wn=Object(Ye.a)(Bn)(zn);const Fn=({classes:e,contentStyle:t,ccd:a,ci:n,cinfo:o,cfg:l,layout:s,labels:r,dims:c,panelRenderers:d,panelInterface:p,sidebar:h,curPage:m,totPages:u,panelData:g,removeLabel:b,setPageNum:f,curDisplayInfo:v,displayInfo:y,relDispPositions:w})=>{let E=i.a.createElement("div",null),x=[v.info.name];w.length>0&&(x=w.map(e=>e.name));const S=x.every(e=>d[e]&&null!==d[e].fn),_=x.every(e=>y[e]&&y[e].isLoaded);if(n&&a&&o&&S&&_&&p){const n=[],x=[];for(let e=0;e<a.length;e+=1){n.push(a[e].panelKey);const t=[];for(let n=0;n<r.length;n+=1)t.push({name:r[n],value:a[e][r[n]],type:o[r[n]].type,desc:o[r[n]].desc});x.push(t)}const S=[];for(let e=0;e<a.length;e+=1){let t,a;"row"===s.arrange?(t=Math.floor(e/s.ncol),a=e%s.ncol):(t=e%s.nrow,a=Math.floor(e/s.nrow)),S.push({rowIndex:t,colIndex:a,iColIndex:s.ncol-a-1,key:n[e],labels:x[e]})}S.sort((e,t)=>e.key>t.key?1:t.key>e.key?-1:0);let _="";if("htmlwidget"===p.type&&(_="_".concat(s.nrow,"_").concat(s.ncol,"_").concat(h,"_").concat(r.length),_+="_".concat(t.width,"_").concat(t.height)),w.length>0){const e=w.map(e=>e.name).join("_");let a="";a=w.map(e=>e.left+e.top+e.width+e.height).reduce((e,t)=>e+t),_="".concat(_,"_").concat(e,"_").concat(a,"_").concat(r.length),_+="_".concat(t.height)}E=i.a.createElement(Dn.a,{onSwipedRight:()=>f("right",m,u),onSwipedLeft:()=>f("left",m,u)},i.a.createElement("div",{className:e.content,style:t},S.map(e=>i.a.createElement(Wn,{key:"".concat(e.key).concat(_),cfg:l,panelKey:e.key,labels:e.labels,labelArr:r,panelRenderers:d,panelData:g[e.key],panelInterface:p,removeLabel:b,dims:c,rowIndex:e.rowIndex,iColIndex:e.iColIndex,curDisplayInfo:v,displayInfo:y,relDispPositions:w}))))}return E};Fn.defaultProps=()=>({ci:void 0,panelInterface:void 0});const Hn={content:{background:"#fdfdfd",position:"absolute",top:nt.header.height,right:0,boxSizing:"border-box",padding:0}},Mn=Object(oe.a)(Rt,At,_e,e=>e._cogDataMutable.iface,ge,xe,be,It,fe,e=>e.panelRenderers,se,jt,de,Oe,pe,e=>e._localPanels,e=>e.relDispPositions,e=>e._displayInfo,(e,t,a,n,i,o,l,s,r,c,d,p,h,m,u,g,b,f)=>{const v=nt.content.panel.pad;let y=Math.round(e/i.ncol,0),w=Math.round(y*o,0);w*i.nrow>t&&(w=Math.round(t/i.nrow,0),y=Math.round(w/o,0));let E=.08*Math.min(y,w);E=Math.max(Math.min(E,26),13);const x=E/1.625-4,S=E-x,_=l.length,O=(v+2)*(i.ncol+1),C=(v+2)*(i.nrow+1)+_*E*i.nrow;let I=Math.round((e-O)/i.ncol,0),k=Math.round(I*o,0),N=0;k*i.nrow+C>t&&(k=Math.round((t-C)/i.nrow,0),I=Math.round(k/o,0),N=(e-(I*i.ncol+O))/2),b.length>0&&(k=t-C,I=e-O,N=0);const D=g,j=((e,t)=>{const a=document.createElement("span");a.style.fontWeight="normal",a.style.fontSize="".concat(t,"px"),a.style.fontFamily="Open Sans",a.style.visibility="hidden";const n=document.body.appendChild(a),i=e.map(e=>(n.innerHTML=e,n.offsetWidth));return document.body.removeChild(n),Object(jn.a)(i)})(l,S)+x;return{contentStyle:{width:e,height:t},ccd:a,ci:n,cinfo:s,cfg:r,layout:i,labels:l,dims:{ww:I,hh:k,labelHeight:E,labelWidth:j,labelPad:x,fontSize:S,nLabels:_,pWidth:I,pHeight:k+_*E,wOffset:N,hOffset:nt.header.height,pPad:v,contentWidth:e},panelRenderers:c,panelInterface:d.info.panelInterface,sidebar:p,curPage:h,totPages:Math.ceil(m/u),panelData:D,curDisplayInfo:d,displayInfo:f,relDispPositions:b}});var Un=Object(s.b)(e=>Mn(e),e=>({removeLabel:(t,a)=>{const n=a.indexOf(t);if(n>-1){const t=Object.assign([],a);t.splice(n,1),e(U(t))}},setPageNum:(t,a,n)=>{let i=a;"right"===t?(i-=1,i<1&&(i+=1)):(i+=1,i>n&&(i-=1)),e(M({pageNum:i}))}}))(Object(Ye.a)(Hn)(Fn));const Vn=Object(oe.a)(Nt,Dt,(e,t)=>({width:e,height:t}));var Gn=Object(s.b)(e=>Vn(e))(Object(Ye.a)({body:{position:"absolute",top:0,left:0,borderRight:"1px solid #ddd",boxSizing:"border-box"}})(({classes:e,width:t,height:a})=>i.a.createElement("div",{className:e.body,style:{width:t,height:a}},i.a.createElement(Sa,null),i.a.createElement(Nn,null),i.a.createElement(Un,null))));const Kn={wrapper:{border:10,boxSizing:"border-box",display:"flex",textDecoration:"none",marginLeft:3,marginTop:4,padding:0,outline:"none",borderRadius:10,whiteSpace:"nowrap",width:"-webkit-fit-content",background:nt.footer.button.background,height:22,transition:"all 450ms cubic-bezier(0.23, 1, 0.32, 1) 0ms"},label:{color:nt.footer.button.color,fontSize:12,fontWeight:400,lineHeight:"20px",paddingLeft:12,paddingRight:12,whiteSpace:"nowrap",WebkitUserSelect:"none"},text:{paddingLeft:5,fontSize:11,fontStyle:"italic"},closeIcon:{display:"inline-block",color:"rgba(0, 0, 0, 0.22)",fill:"rgba(0, 0, 0, 0.22)",height:21,width:21,transition:"all 450ms cubic-bezier(0.23, 1, 0.32, 1) 0ms",cursor:"pointer",margin:"1px 1px 0px -8px",WebkitUserSelect:"none","&:hover":{color:Object(Yt.fade)("rgba(0, 0, 0, 0.22)",.4),fill:Object(Yt.fade)("rgba(0, 0, 0, 0.22)",.4)}},indIcon:{paddingRight:5}};var Yn=Object(s.b)(()=>({}),e=>({handleStateClose:t=>{"sort"===t.type?(e(V(t.index)),e(M({pageNum:1}))):"filter"===t.type&&(e(K(t.label,"remove")),e(G(t.label)),e(M({pageNum:1})))}}))(Object(Ye.a)(Kn)(({classes:e,label:t,icon:a,text:n,index:o,type:l,handleStateClose:s})=>{let r="";""!==a&&(r=i.a.createElement("i",{className:"".concat(a," ").concat(e.indIcon)}));let c="";return""!==n&&(c=i.a.createElement("span",{className:e.text},"(".concat(n,")"))),i.a.createElement("div",{type:"button",className:e.wrapper},i.a.createElement("span",{className:e.label},r,t,c),i.a.createElement("svg",{viewBox:"0 0 24 24",className:e.closeIcon,key:"icon",onClick:()=>s({label:t,index:o,type:l})},i.a.createElement("path",{d:"M12 2C6.47 2 2 6.47 2 12s4.47 10 10 10 10-4.47 10-10S17.53 2 12 2zm5 13.59L15.59 17 12 13.41 8.41 17 7 15.59 10.59 12 7 8.41 8.41 7 12 10.59 15.59 7 17 8.41 13.41 12 17 15.59z"})))})),qn=a(281),Qn=a(210),Jn=a(280),$n=a(145),Xn=a.n($n),Zn=a(144),ei=a.n(Zn);const ti=Object(Jn.a)(e=>({root:{"& .MuiTextField-root":{margin:e.spacing(1),width:"25ch"}},button:{margin:e.spacing(1)}}));function ai({open:e,handleClose:t,displayInfo:a}){const n=ti(),o=i.a.useState(localStorage.getItem("__trelliscope_username")||""),l=Object(dn.a)(o,2),r=l[0],c=l[1],d=i.a.useState(localStorage.getItem("__trelliscope_email")||""),p=Object(dn.a)(d,2),h=p[0],m=p[1],u=i.a.useState(localStorage.getItem("__trelliscope_jobtitle")||""),g=Object(dn.a)(u,2),b=g[0],f=g[1],v=i.a.useState(localStorage.getItem("__trelliscope_otherinfo")||""),y=Object(dn.a)(v,2),w=y[0],E=y[1],x=i.a.useState(0),S=Object(dn.a)(x,2),_=S[0],O=S[1],C=i.a.useState(!1),I=Object(dn.a)(C,2),k=I[0],N=I[1],D=Object(s.c)(ce);if(!D.isLoaded||void 0===D.crossfilter)return"";if(!a.has_inputs||"localStorage"!==a.input_type)return"";const j="".concat(a.group,"_:_").concat(a.name),T=new RegExp("^".concat(j)),L=a.input_csv_vars||[],R={},A=[];Object.keys(localStorage).forEach(e=>{if(T.test(e)){const t=e.split("_:_"),a=t[2];void 0===R[a]&&(R[a]={}),R[a][t[3]]=localStorage.getItem(e),A.indexOf(t[3])<0&&A.push(t[3])}});const P=["panelKey"],z=D.crossfilter.all(),B=z.map(e=>e.panelKey);P.push(...L,...A),P.push("fullname","email","jobtitle","otherinfo","timestamp");const W=Object.keys(R).map((e,t)=>{const a=[];if(L.length>0){const t=B.indexOf(e);a.push(L.map(e=>z[t][e]))}const n=A.map(t=>R[e][t]?'"'.concat(R[e][t].replace(/"/g,'""'),'"'):""),i=[];return 0===t?i.push('"'.concat((localStorage.getItem("__trelliscope_username")||"").replace(/"/g,'""'),'"'),'"'.concat((localStorage.getItem("__trelliscope_email")||"").replace(/"/g,'""'),'"'),'"'.concat((localStorage.getItem("__trelliscope_jobtitle")||"").replace(/"/g,'""'),'"'),'"'.concat((localStorage.getItem("__trelliscope_otherinfo")||"").replace(/"/g,'""'),'"'),(new Date).toISOString()):i.push("","","","",""),[e,...a,n,i]});return i.a.createElement("div",null,i.a.createElement(Ze.a,{open:e,onClose:()=>{O(0),t()},"aria-labelledby":"alert-dialog-title","aria-describedby":"alert-dialog-description"},i.a.createElement(Xe.a,{id:"alert-dialog-title"},"Export user inputs"),i.a.createElement(et.a,{dividers:!0},i.a.createElement(ct.a,{activeStep:_,alternativeLabel:!0},["User info","Download csv","Compose email"].map(e=>i.a.createElement(dt.a,{key:e},i.a.createElement(Qn.a,null,e)))),0===_&&i.a.createElement("div",null,i.a.createElement(qn.a,null,"Before exporting the inputs you have provided, we would like to gather some information about you. Please provide at least your full name, after which you will be able to click the 'Export' tab in this window to proceed with the export."),i.a.createElement("div",null,i.a.createElement(Qa.a,{style:{marginBottom:15},required:!0,label:"Full Name",fullWidth:!0,value:r,onChange:e=>{c(e.target.value),localStorage.setItem("__trelliscope_username",e.target.value)}}),i.a.createElement(Qa.a,{style:{marginBottom:15},label:"Email Address",fullWidth:!0,value:h,onChange:e=>{m(e.target.value),localStorage.setItem("__trelliscope_email",e.target.value)}}),i.a.createElement(Qa.a,{style:{marginBottom:15},label:"Job Title",fullWidth:!0,value:b,onChange:e=>{f(e.target.value),localStorage.setItem("__trelliscope_jobtitle",e.target.value)}}),i.a.createElement(Qa.a,{style:{marginBottom:15},multiline:!0,rows:3,label:"Additional Contact Information",fullWidth:!0,value:w,onChange:e=>{E(e.target.value),localStorage.setItem("__trelliscope_otherinfo",e.target.value)}}))),1===_&&i.a.createElement("div",null,i.a.createElement(qn.a,{id:"alert-dialog-description"},i.a.createElement("p",{style:{marginTop:0}},"A csv file of the inputs you provided has been created. By clicking the 'Compose Email' button below, an email will be drafted and opened in your email client to relay this csv file back to us, at ".concat(a.input_email,".")),i.a.createElement("p",null,"To complete the email, use the 'Download csv' button to download the csv and add it as an attachment to the email before sending. As an alternative, you can download the csv file and compose your own email, sending it to us at ".concat(a.input_email,"."))),i.a.createElement("div",{style:{textAlign:"center"}},i.a.createElement(at.a,{variant:"contained",color:"primary",className:n.button,endIcon:i.a.createElement(ei.a,null),onClick:()=>{const e=[P.join(","),...W.map(e=>e.join(","))].join("\n"),t=new Blob([e],{type:"text/csv"}),n=document.createElement("a");n.download="".concat(a.name,"_").concat((new Date).toISOString().split("T")[0],".csv"),n.href=window.URL.createObjectURL(t),n.click(),N(!0)}},"Download CSV"))),2===_&&i.a.createElement("div",null,i.a.createElement(qn.a,{id:"alert-dialog-description"},i.a.createElement("p",{style:{marginTop:0}},"By clicking the 'Compose Email' button below, an email will be drafted and opened in your email client to relay this csv file back to us, at ".concat(a.input_email,".")),i.a.createElement("p",null,i.a.createElement("strong",null,"Note: You must manually attach the csv file downloaded in the previous step to this email prior to sending."))),i.a.createElement("div",{style:{textAlign:"center"}},i.a.createElement(at.a,{variant:"contained",color:"primary",className:n.button,endIcon:i.a.createElement(Xn.a,null),onClick:()=>{const e="From: ".concat(r,"%0D%0A%0D%0AEmail: ").concat(h,"%0D%0A%0D%0AJob Title: ").concat(encodeURIComponent(b),"%0D%0A%0D%0AOther contact info: ").concat(encodeURIComponent(w),"%0D%0A%0D%0ADisplay: ").concat(a.group," -> ").concat(a.name,"%0D%0A%0D%0A(attach downloaded csv file here before sending)"),t=document.createElement("a");t.href="mailto:".concat(a.input_email,"?subject=").concat("Trelliscope input","&body=").concat(e),t.click()}},"Compose Email"))),i.a.createElement("div",{style:{textAlign:"right"}},i.a.createElement(at.a,{disabled:0===_,onClick:()=>{O(e=>e-1)},className:n.button},"Back"),_<=1&&i.a.createElement(at.a,{disabled:0===_&&""===r||1===_&&!k,variant:"contained",color:"primary",onClick:()=>{O(e=>e+1)},className:n.button},"Next"))),i.a.createElement(tt.a,null,i.a.createElement(at.a,{onClick:()=>{Object.keys(localStorage).forEach(e=>{T.test(e)&&localStorage.removeItem(e)})}},"Clear all inputs"),i.a.createElement(at.a,{onClick:()=>{O(0),t()},color:"primary",autoFocus:!0},"Close"))))}const ni=({classes:e,style:t,sort:a,filter:n,nFilt:o,nPanels:l,displayInfo:s})=>{const r=i.a.useState(!1),c=Object(dn.a)(r,2),d=c[0],p=c[1];let h="",m="",u="";return a.length>0&&(h=i.a.createElement("div",{className:e.sectionWrapper},i.a.createElement("div",{className:e.sectionText},"Sorting on:"),i.a.createElement("div",{className:e.chipWrapper},a.map((e,t)=>i.a.createElement(Yn,{key:"".concat(e.name,"_sortchip"),label:e.name,icon:e.icon,text:"",index:t,type:"sort"}))))),n.length>0&&(m=i.a.createElement("div",{className:e.sectionWrapper},i.a.createElement("div",{className:e.sectionText},"Filtering on:"),i.a.createElement("div",{className:e.chipWrapper},n.map((e,t)=>i.a.createElement(Yn,{key:"".concat(e.name,"_filterchip"),label:e.name,icon:"",text:e.text,index:t,type:"filter"}))),i.a.createElement("div",{className:e.filterText},"(".concat(o," of ").concat(l," panels)")))),n.length>0&&a.length>0&&(u=i.a.createElement("div",{className:e.spacer})),i.a.createElement("div",{className:e.wrapper,style:t},i.a.createElement("div",{className:e.inner},h,u,m),s.has_inputs&&"localStorage"===s.input_type&&i.a.createElement("div",{className:e.buttonDiv},i.a.createElement(at.a,{size:"small",variant:"contained",color:"primary",onClick:()=>{p(!0)}},"Export Inputs")),i.a.createElement(ai,{open:d,handleClose:()=>{p(!1)},displayInfo:s}))};ni.defaultProps=()=>({nPanels:0});const ii={wrapper:{position:"absolute",boxSizing:"border-box",left:0,height:nt.footer.height,paddingLeft:10,margin:0,lineHeight:"".concat(nt.footer.height,"px"),fontSize:.5*nt.footer.height,fontWeight:300,background:nt.footer.background,color:nt.footer.color,display:"flex",flexDirection:"row",overflowX:"auto",overflowY:"hidden",zIndex:1001},inner:{display:"flex",flexDirection:"row",whiteSpace:"nowrap",paddingRight:10},sectionWrapper:{display:"flex",flexDirection:"row"},chipWrapper:{display:"flex",flexDirection:"row"},sectionText:{marginRight:3},spacer:{width:12},filterText:{marginLeft:5},buttonDiv:{position:"absolute",right:0,bottom:0}},oi=Object(oe.a)(ue,se,(e,t)=>{const a=[];for(let n=0;n<e.length;n+=1){const i=e[n].name,o=t.info.cogInfo[i].type;let l="icon-sort-amount";"factor"===o?l="icon-sort-alpha":"numeric"===o&&(l="icon-sort-numeric"),l="".concat(l,"-").concat(e[n].dir),a.push({name:i,icon:l})}return a}),li=Object(oe.a)(e=>e.filter,se,(e,t)=>{const a=Object.keys(e.state),n=[];for(let i=0;i<a.length;i+=1){const o=e.state[a[i]];if(void 0!==o.value){let e="";if("numeric"===o.varType)void 0===o.value.from&&void 0!==o.value.to?e="< ".concat(o.value.to):void 0!==o.value.from&&void 0===o.value.to?e="> ".concat(o.value.from):void 0!==o.value.from&&void 0!==o.value.to&&(e="".concat(o.value.from," -- ").concat(o.value.to));else if("factor"===o.varType){const a=15,n=o.value.length;let i=0,l=0;for(;l<n&&i<=a;)i=i+o.value[l].length+2,l+=1;if(l===n)e=o.value.sort().join(", ");else{const a=t.info.cogInfo[o.name].levels.length;e="".concat(o.value.length," of ").concat(a)}}n.push({name:a[i],text:e})}}return n}),si=Object(oe.a)(Nt,oi,li,Oe,se,ye,At,(e,t,a,n,i,o,l)=>({style:{width:e-(o?0:nt.footer.height),top:l+nt.header.height},sort:t,filter:a,nFilt:n,displayInfo:i.info,nPanels:i.info.n}));var ri=Object(s.b)(e=>si(e))(Object(Ye.a)(ii)(ni));class ci extends i.a.Component{constructor(e){super(e),this.yOffset=window.pageYOffset}componentDidMount(){const e=this.props,t=e.singlePageApp,a=e.fullscreen,n=e.sidebar,i=e.dialog,o=e.appId,l=e.toggleFullscreen,s=e.ww,r=e.hh;t||!a||""!==n||i||Qe.a.bindGlobal("esc",()=>l(!1,o,{width:s,height:r},this.yOffset))}UNSAFE_componentWillReceiveProps(e){const t=this.props,a=t.singlePageApp,n=t.ww,i=t.hh;a||(e.fullscreen&&""===e.sidebar&&!e.dialog&&Qe.a.bindGlobal("esc",()=>e.toggleFullscreen(!1,e.appId,{width:n,height:i},this.yOffset)),e.dialog&&Qe.a.unbind("esc"))}componentWillUnmount(){const e=this.props,t=e.singlePageApp,a=e.fullscreen,n=e.sidebar,i=e.dialog;t||!a||""!==n||i||Qe.a.unbind("esc")}render(){const e=this.props,t=e.singlePageApp,a=e.fullscreen,n=e.appId,o=e.ww,l=e.hh,s=e.toggleFullscreen;if(t)return null;const r=this.props.classes,c=a?"icon-minimize":"icon-maximize";return i.a.createElement("button",{type:"button",className:r.button,onClick:()=>{a||(this.yOffset=window.pageYOffset),s(!a,n,{width:o,height:l},this.yOffset)}},i.a.createElement("i",{className:"".concat(c," ").concat(r.icon)}))}}const di={button:{position:"absolute",right:0,bottom:0,textAlign:"center",background:Object(Yt.emphasize)(nt.footer.background,.2),width:nt.footer.height,height:nt.footer.height,cursor:"pointer",border:"none",transition:"all 100ms ease-in","&:hover":{background:Object(Yt.emphasize)(nt.footer.background,.3)}},icon:{color:Object(Yt.emphasize)(nt.footer.background,.8),fontSize:"".concat(nt.footer.height-16,"px")}},pi=Object(oe.a)(jt,Ee,we,ve,ye,e=>e.ui.origWidth,e=>e.ui.origHeight,(e,t,a,n,i,o,l)=>({sidebar:e,dialog:t,fullscreen:a,appId:n,singlePageApp:i,ww:o,hh:l}));var hi=Object(s.b)(e=>pi(e),e=>({toggleFullscreen:(t,a,n,i)=>{const o=document.getElementById(a),l={};if(t){E(document.body,"trelliscope-fullscreen-body"),E(document.getElementsByTagName("html")[0],"trelliscope-fullscreen-html"),E(o,"trelliscope-fullscreen-el"),l.width=window.innerWidth,l.height=window.innerHeight;const e=document.getElementById("trelliscope-fullscreen-div");e.style.display="block",e.appendChild(o)}else x(document.body,"trelliscope-fullscreen-body"),x(document.getElementsByTagName("html")[0],"trelliscope-fullscreen-html"),x(o,"trelliscope-fullscreen-el"),l.width=n.width,l.height=n.height,document.getElementById("".concat(o.id,"-parent")).appendChild(o),document.getElementById("trelliscope-fullscreen-div").style.display="none",window.scrollTo(window.pageXOffset,i);e((e=>({type:"SET_FULLSCREEN",fullscreen:e}))(t)),e(A(l))}}))(Object(Ye.a)(di)(ci)),mi=a(289);const ui=Object(oe.a)(e=>e.errorMsg,e=>({errorMsg:e}));var gi=Object(s.b)(e=>ui(e),e=>({handleClose:()=>{e(te(""))}}))(({errorMsg:e,handleClose:t})=>i.a.createElement(mi.a,{anchorOrigin:{vertical:"bottom",horizontal:"center"},open:""!==e,onClose:t,SnackbarContentProps:{"aria-describedby":"message-id"},message:i.a.createElement("span",{id:"message-id"},e),action:[i.a.createElement(at.a,{key:"undo",color:"secondary",dense:!0,onClick:t},"Close")]}));var bi=()=>i.a.createElement("div",null,i.a.createElement(ba,null),i.a.createElement(Gn,null),i.a.createElement(ri,null),i.a.createElement(hi,null),i.a.createElement(gi,null));const fi=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function vi(e,t){navigator.serviceWorker.register(e).then(e=>{e.onupdatefound=()=>{const a=e.installing;null!=a&&(a.onstatechange=()=>{"installed"===a.state&&(navigator.serviceWorker.controller?(console.log("New content is available and will be used when all tabs for this page are closed. See https://bit.ly/CRA-PWA."),t&&t.onUpdate&&t.onUpdate(e)):(console.log("Content is cached for offline use."),t&&t.onSuccess&&t.onSuccess(e)))})}}).catch(e=>{console.error("Error during service worker registration:",e)})}const yi=(e,t,a)=>{let n=!0,o={},m=!1;void 0!==a&&("boolean"===typeof a.logger?n=a.logger:void 0!==a.logger&&(o=a.logger),void 0!==a.callbacks&&(m=!0));const g=document.getElementById(e);E(g,"trelliscope-app"),E(g,"trelliscope-app-container"),"relative"!==g.style.position&&(g.style.position="relative"),"hidden"!==g.style.overflow&&(g.style.overflow="hidden"),g.style["font-family"]='"Open Sans", sans-serif',g.style["font-weight"]=300,g.style["-webkit-tap-highlight-color"]="rgba(0,0,0,0)";const f=void 0===g.style.height||""===g.style.height||"100%"===g.style.height,v=void 0===g.style.width||""===g.style.width||"100%"===g.style.width;let w=!1,x=!1;if(g.classList.contains("trelliscope-not-spa")||!f&&!v){const e=document.createElement("div");if(e.style.width="100%",e.style.height="100%",e.style.display="none",e.id="trelliscope-fullscreen-div",document.getElementsByTagName("body")[0].appendChild(e),f){0===[].slice.call(g.parentNode.childNodes).map(e=>3!==e.nodeType&&8!==e.nodeType).reduce((e,t)=>e+t)-1&&(g.style.height="".concat(g.parentNode.clientHeight,"px"),g.style.width="".concat(g.parentNode.clientWidth,"px"))}const t=g.parentNode,a=document.createElement("div");a.id="".concat(g.id,"-parent"),t.replaceChild(a,g),a.appendChild(g)}else w=!0,x=!0,g.style.width="100%",g.style.height="100%",E(document.body,"trelliscope-fullscreen-body"),E(document.getElementsByTagName("html")[0],"trelliscope-fullscreen-html");const S={};w?(S.width=window.innerWidth,S.height=window.innerHeight):(S.width=g.clientWidth,S.height=g.clientHeight),g.classList.contains("trelliscope-not-spa")||!f&&!v||(w=!0,x=!0);const _=[c.a,je];if(n){const e=Object(d.createLogger)(o);_.push(e)}if(m){const e=Ce(a.callbacks);_.push(e)}w&&_.push(y);const C=Object(r.d)(Ke,{appId:e,singlePageApp:w,fullscreen:x},Object(r.a)(..._));C.dispatch(A(S)),C.dispatch(P(S)),C.dispatch(((e="config.jsonp",t="",a=!1)=>n=>{const i=a?window.location.hash:"";if(!("string"===typeof e||e instanceof String)){n(z(e.config)),n(Y(e.displayList));const t=e.displayList[0].name,a=e.displayList[0].group,i=e.displayList[0].desc;n(q(t,a,i)),n($(t,a));const o=e.displayObj.cogInterface;n(X(t,a,e.displayObj)),n(Z(o)),n({type:"SET_LOCAL_PANELS",dat:e.panels}),ae(o,e.cogData,e.displayObj,n,""),ne(e.displayObj,e.config,n)}else{n({type:"REQUEST_CONFIG"});const o="__loadDisplayList__".concat(t),l="__loadTrscopeConfig__".concat(t),s=e.replace(/[^\/]*$/,""),r=e=>{let t=e;return/^https?:\/\/|^file:\/\/|^\//.test(e)||(t=s,""!==e&&(t+="".concat(e,"/"))),t};window[l]=e=>{if(e.display_base=r(e.display_base),e.config_base=s,e.cog_server.info.base=r(e.cog_server.info.base),n(z(e)),e.ga_id&&O.a.initialize(e.ga_id),!0===e.require_token){const e="".concat(window.devicePixelRatio||"").concat(navigator.userAgent.replace(/\D+/g,"")),t="".concat(navigator.language.length||"").concat(window.screen.colorDepth||""),a="".concat((new Date).getTimezoneOffset()).concat(navigator.platform.length||""),i="".concat(window.screen.height||"").concat(window.screen.width||"").concat(window.screen.pixelDepth||""),o="".concat((new Date).toLocaleDateString().replace(/\D+/g,"")),l="".concat(e).concat(t).concat(a).concat(i).concat(o);if(localStorage.getItem("TRELLISCOPE_TOKEN")!==l)return void n(te("Visualization could not be loaded because it is not embedded in a properly authenticated website."))}window[o]=o=>{o.sort((e,t)=>(void 0===e.order?1:e.order)>(void 0===t.order?1:t.order)?1:-1),n(Y(o));const l={};if(i.replace("#","").split("&").forEach(e=>{const t=e.split("=");l[t[0]]=t[[1]]}),l.display){const a=o.map(e=>e.name).indexOf(l.display);if(a>-1){const l=o[a];n(q(l.name,l.group,l.desc)),n(ie(l.name,l.group,e,t,i))}}else a&&o.length>1&&(n(W(!0)),n(F(!0)))},"jsonp"===e.data_type?I()({url:"".concat(e.display_base,"displayList.jsonp"),callbackName:o,error:e=>n(te("Couldn't load display list: ".concat(e.url)))}):R({url:"".concat(e.display_base,"displayList.json"),callback:window[o]}).on("error",e=>n(te("Couldn't load display list: ".concat(e.target.responseURL))))};const c=/\.([0-9a-z]+)(?:[\?#]|$)/i,d=e.match(c)[0];".jsonp"===d?I()({url:e,callbackName:l,error:e=>n(te("Couldn't load config: ".concat(e.url)))}):".json"===d?R({url:e,callback:window[l]}):n(te("Config specified as ".concat(e," must have extension '.json' or '.jsonp'")))}})(t,e,w)),window.addEventListener("resize",()=>{C.getState().fullscreen&&C.dispatch(A({height:window.innerHeight,width:window.innerWidth}))});const k=Object(p.a)({palette:{primary:{light:u.a.A100,main:u.a.A200},secondary:{light:b.a[200],main:b.a[700]}},typography:{fontFamily:'"Open Sans", sans-serif',fontWeightLight:200,fontWeightRegular:300,fontWeightMedium:400}});return l.a.render(i.a.createElement(h.a,{theme:k},i.a.createElement(s.a,{store:C},i.a.createElement(bi,null))),document.getElementById(e)),{resize:(e,t)=>{g.style.height="".concat(t,"px"),g.style.width="".concat(e,"px"),C.dispatch(P({width:e,height:t})),C.dispatch(A({width:e,height:t}))},setLayout:(e,t)=>{C.dispatch(M({nrow:e,ncol:t}))},currentCogs:()=>_e(C.getState())}};window.trelliscopeApp=yi,yi("22375e25","_test/example_gapminder/config.jsonp",{logger:!0}),function(e){if("serviceWorker"in navigator){if(new URL("",window.location.href).origin!==window.location.origin)return;window.addEventListener("load",()=>{const t="".concat("","/service-worker.js");fi?(!function(e,t){fetch(e).then(a=>{const n=a.headers.get("content-type");404===a.status||null!=n&&-1===n.indexOf("javascript")?navigator.serviceWorker.ready.then(e=>{e.unregister().then(()=>{window.location.reload()})}):vi(e,t)}).catch(()=>{console.log("No internet connection found. App is running in offline mode.")})}(t,e),navigator.serviceWorker.ready.then(()=>{console.log("This web app is being served cache-first by a service worker. To learn more, visit https://bit.ly/CRA-PWA")})):vi(t,e)})}}()}},[[172,1,2]]]);
//# sourceMappingURL=main.bb55b2e9.chunk.js.map